Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='192', model='TimeBridge', data='ETTh2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=192, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=15, pct_start=0.2, learning_rate=0.0001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 192_TimeBridge_ETTh2_M_ft720_sl48_ll192_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 1.6176932
	speed: 0.0174s/iter; left time: 838.7057s
	iters: 200, epoch: 1 | loss: 1.4045579
	speed: 0.0124s/iter; left time: 598.5148s
	iters: 300, epoch: 1 | loss: 1.4328585
	speed: 0.0127s/iter; left time: 607.2386s
	iters: 400, epoch: 1 | loss: 1.8067627
	speed: 0.0129s/iter; left time: 620.2383s
Epoch: 1 cost time: 6.618853330612183
Epoch: 1, Steps: 483 | Train Loss: 1.6985043 Vali Loss: 0.3046322 Test Loss: 0.3592823
Validation loss decreased (inf --> 0.304632).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5241585
	speed: 0.1612s/iter; left time: 7693.5028s
	iters: 200, epoch: 2 | loss: 2.2612450
	speed: 0.0123s/iter; left time: 584.0121s
	iters: 300, epoch: 2 | loss: 1.5637484
	speed: 0.0127s/iter; left time: 604.5142s
	iters: 400, epoch: 2 | loss: 1.4461296
	speed: 0.0130s/iter; left time: 616.7931s
Epoch: 2 cost time: 6.252871513366699
Epoch: 2, Steps: 483 | Train Loss: 1.5719337 Vali Loss: 0.2857260 Test Loss: 0.3442365
Validation loss decreased (0.304632 --> 0.285726).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2614069
	speed: 0.1594s/iter; left time: 7529.0349s
	iters: 200, epoch: 3 | loss: 1.4702626
	speed: 0.0125s/iter; left time: 588.9499s
	iters: 300, epoch: 3 | loss: 1.6428955
	speed: 0.0129s/iter; left time: 606.5362s
	iters: 400, epoch: 3 | loss: 1.3636552
	speed: 0.0124s/iter; left time: 579.8025s
Epoch: 3 cost time: 6.425176620483398
Epoch: 3, Steps: 483 | Train Loss: 1.5336343 Vali Loss: 0.2837268 Test Loss: 0.3368886
Validation loss decreased (0.285726 --> 0.283727).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2892246
	speed: 0.1566s/iter; left time: 7320.8396s
	iters: 200, epoch: 4 | loss: 1.2478050
	speed: 0.0123s/iter; left time: 575.7112s
	iters: 300, epoch: 4 | loss: 1.5449859
	speed: 0.0121s/iter; left time: 564.3365s
	iters: 400, epoch: 4 | loss: 1.5505685
	speed: 0.0129s/iter; left time: 599.9115s
Epoch: 4 cost time: 6.16617488861084
Epoch: 4, Steps: 483 | Train Loss: 1.5189819 Vali Loss: 0.2776579 Test Loss: 0.3350730
Validation loss decreased (0.283727 --> 0.277658).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0360880
	speed: 0.1623s/iter; left time: 7509.6760s
	iters: 200, epoch: 5 | loss: 1.4386606
	speed: 0.0127s/iter; left time: 584.9432s
	iters: 300, epoch: 5 | loss: 1.2086684
	speed: 0.0127s/iter; left time: 582.8524s
	iters: 400, epoch: 5 | loss: 1.9277004
	speed: 0.0128s/iter; left time: 588.8452s
Epoch: 5 cost time: 6.401066303253174
Epoch: 5, Steps: 483 | Train Loss: 1.5123895 Vali Loss: 0.2806071 Test Loss: 0.3339769
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 6 | loss: 1.5895722
	speed: 0.1665s/iter; left time: 7621.1865s
	iters: 200, epoch: 6 | loss: 1.4463513
	speed: 0.0124s/iter; left time: 568.0513s
	iters: 300, epoch: 6 | loss: 1.3366164
	speed: 0.0125s/iter; left time: 569.7000s
	iters: 400, epoch: 6 | loss: 1.5933189
	speed: 0.0119s/iter; left time: 542.6617s
Epoch: 6 cost time: 6.2459306716918945
Epoch: 6, Steps: 483 | Train Loss: 1.5087631 Vali Loss: 0.2805343 Test Loss: 0.3342564
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 7 | loss: 1.7362874
	speed: 0.1624s/iter; left time: 7358.1176s
	iters: 200, epoch: 7 | loss: 1.3393457
	speed: 0.0123s/iter; left time: 557.7548s
	iters: 300, epoch: 7 | loss: 1.4411323
	speed: 0.0121s/iter; left time: 544.7060s
	iters: 400, epoch: 7 | loss: 1.3084700
	speed: 0.0130s/iter; left time: 586.0755s
Epoch: 7 cost time: 6.285374402999878
Epoch: 7, Steps: 483 | Train Loss: 1.5066843 Vali Loss: 0.2785499 Test Loss: 0.3332957
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 8 | loss: 1.5109639
	speed: 0.1639s/iter; left time: 7347.1192s
	iters: 200, epoch: 8 | loss: 1.1546594
	speed: 0.0130s/iter; left time: 583.3261s
	iters: 300, epoch: 8 | loss: 1.5227511
	speed: 0.0130s/iter; left time: 578.9429s
	iters: 400, epoch: 8 | loss: 1.7357563
	speed: 0.0130s/iter; left time: 580.9450s
Epoch: 8 cost time: 6.802191734313965
Epoch: 8, Steps: 483 | Train Loss: 1.5058419 Vali Loss: 0.2797184 Test Loss: 0.3335803
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 9 | loss: 1.3199036
	speed: 0.1589s/iter; left time: 7044.0285s
	iters: 200, epoch: 9 | loss: 1.5194910
	speed: 0.0125s/iter; left time: 553.9141s
	iters: 300, epoch: 9 | loss: 1.4722917
	speed: 0.0126s/iter; left time: 557.3682s
	iters: 400, epoch: 9 | loss: 1.5640743
	speed: 0.0121s/iter; left time: 531.0221s
Epoch: 9 cost time: 6.186448812484741
Epoch: 9, Steps: 483 | Train Loss: 1.5054406 Vali Loss: 0.2800641 Test Loss: 0.3334608
EarlyStopping counter: 5 out of 15
	iters: 100, epoch: 10 | loss: 1.3377777
	speed: 0.1604s/iter; left time: 7032.6383s
	iters: 200, epoch: 10 | loss: 1.8760682
	speed: 0.0130s/iter; left time: 570.0643s
	iters: 300, epoch: 10 | loss: 1.4200531
	speed: 0.0125s/iter; left time: 544.0213s
	iters: 400, epoch: 10 | loss: 1.5037839
	speed: 0.0124s/iter; left time: 537.9106s
Epoch: 10 cost time: 6.573164224624634
Epoch: 10, Steps: 483 | Train Loss: 1.5053952 Vali Loss: 0.2799678 Test Loss: 0.3332419
EarlyStopping counter: 6 out of 15
	iters: 100, epoch: 11 | loss: 1.4195575
	speed: 0.1560s/iter; left time: 6766.9043s
	iters: 200, epoch: 11 | loss: 1.6782169
	speed: 0.0130s/iter; left time: 560.6477s
	iters: 300, epoch: 11 | loss: 1.4477156
	speed: 0.0124s/iter; left time: 534.9908s
	iters: 400, epoch: 11 | loss: 1.6325226
	speed: 0.0130s/iter; left time: 559.6754s
Epoch: 11 cost time: 6.318265438079834
Epoch: 11, Steps: 483 | Train Loss: 1.5049428 Vali Loss: 0.2799141 Test Loss: 0.3332555
EarlyStopping counter: 7 out of 15
	iters: 100, epoch: 12 | loss: 1.5531688
	speed: 0.1587s/iter; left time: 6807.9742s
	iters: 200, epoch: 12 | loss: 1.4525758
	speed: 0.0123s/iter; left time: 524.6853s
	iters: 300, epoch: 12 | loss: 1.3856534
	speed: 0.0123s/iter; left time: 525.8510s
	iters: 400, epoch: 12 | loss: 1.8053286
	speed: 0.0124s/iter; left time: 527.9944s
Epoch: 12 cost time: 6.194916486740112
Epoch: 12, Steps: 483 | Train Loss: 1.5048822 Vali Loss: 0.2798681 Test Loss: 0.3332391
EarlyStopping counter: 8 out of 15
	iters: 100, epoch: 13 | loss: 1.7289166
	speed: 0.1556s/iter; left time: 6596.5506s
	iters: 200, epoch: 13 | loss: 1.4293194
	speed: 0.0120s/iter; left time: 506.0168s
	iters: 300, epoch: 13 | loss: 1.1845071
	speed: 0.0121s/iter; left time: 510.6294s
	iters: 400, epoch: 13 | loss: 1.8365042
	speed: 0.0125s/iter; left time: 527.9727s
Epoch: 13 cost time: 6.12742280960083
Epoch: 13, Steps: 483 | Train Loss: 1.5049448 Vali Loss: 0.2798706 Test Loss: 0.3332595
EarlyStopping counter: 9 out of 15
	iters: 100, epoch: 14 | loss: 1.2329903
	speed: 0.1550s/iter; left time: 6498.9792s
	iters: 200, epoch: 14 | loss: 1.3752995
	speed: 0.0122s/iter; left time: 510.3984s
	iters: 300, epoch: 14 | loss: 1.4556876
	speed: 0.0123s/iter; left time: 511.5712s
	iters: 400, epoch: 14 | loss: 1.5313756
	speed: 0.0119s/iter; left time: 494.2742s
Epoch: 14 cost time: 6.036467552185059
Epoch: 14, Steps: 483 | Train Loss: 1.5052106 Vali Loss: 0.2798215 Test Loss: 0.3332563
EarlyStopping counter: 10 out of 15
	iters: 100, epoch: 15 | loss: 1.3640667
	speed: 0.1582s/iter; left time: 6555.7996s
	iters: 200, epoch: 15 | loss: 1.7178540
	speed: 0.0124s/iter; left time: 513.3791s
	iters: 300, epoch: 15 | loss: 1.3450453
	speed: 0.0119s/iter; left time: 491.6611s
	iters: 400, epoch: 15 | loss: 1.7605333
	speed: 0.0124s/iter; left time: 511.0882s
Epoch: 15 cost time: 6.100841283798218
Epoch: 15, Steps: 483 | Train Loss: 1.5047755 Vali Loss: 0.2795687 Test Loss: 0.3332546
EarlyStopping counter: 11 out of 15
	iters: 100, epoch: 16 | loss: 1.3678424
	speed: 0.1623s/iter; left time: 6649.1223s
	iters: 200, epoch: 16 | loss: 1.4261408
	speed: 0.0124s/iter; left time: 506.9640s
	iters: 300, epoch: 16 | loss: 1.4676195
	speed: 0.0127s/iter; left time: 515.7088s
	iters: 400, epoch: 16 | loss: 1.5334196
	speed: 0.0133s/iter; left time: 539.6909s
Epoch: 16 cost time: 6.875136852264404
Epoch: 16, Steps: 483 | Train Loss: 1.5049480 Vali Loss: 0.2798066 Test Loss: 0.3332553
EarlyStopping counter: 12 out of 15
	iters: 100, epoch: 17 | loss: 1.2261559
	speed: 0.1597s/iter; left time: 6462.4380s
	iters: 200, epoch: 17 | loss: 1.7636418
	speed: 0.0124s/iter; left time: 500.5109s
	iters: 300, epoch: 17 | loss: 1.5614579
	speed: 0.0122s/iter; left time: 492.0000s
	iters: 400, epoch: 17 | loss: 1.6309305
	speed: 0.0123s/iter; left time: 494.6625s
Epoch: 17 cost time: 6.155669689178467
Epoch: 17, Steps: 483 | Train Loss: 1.5048562 Vali Loss: 0.2797884 Test Loss: 0.3332555
EarlyStopping counter: 13 out of 15
	iters: 100, epoch: 18 | loss: 1.4085084
	speed: 0.1593s/iter; left time: 6369.0401s
	iters: 200, epoch: 18 | loss: 1.3590980
	speed: 0.0135s/iter; left time: 536.7270s
	iters: 300, epoch: 18 | loss: 1.8106494
	speed: 0.0122s/iter; left time: 486.3983s
	iters: 400, epoch: 18 | loss: 1.3441184
	speed: 0.0124s/iter; left time: 494.1038s
Epoch: 18 cost time: 6.301249742507935
Epoch: 18, Steps: 483 | Train Loss: 1.5047866 Vali Loss: 0.2794860 Test Loss: 0.3332555
EarlyStopping counter: 14 out of 15
	iters: 100, epoch: 19 | loss: 1.3240008
	speed: 0.1555s/iter; left time: 6142.4687s
	iters: 200, epoch: 19 | loss: 1.2445154
	speed: 0.0126s/iter; left time: 497.1930s
	iters: 300, epoch: 19 | loss: 1.7277874
	speed: 0.0134s/iter; left time: 527.5755s
	iters: 400, epoch: 19 | loss: 1.4703475
	speed: 0.0118s/iter; left time: 462.7848s
Epoch: 19 cost time: 6.2513158321380615
Epoch: 19, Steps: 483 | Train Loss: 1.5048867 Vali Loss: 0.2798666 Test Loss: 0.3332555
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : 192_TimeBridge_ETTh2_M_ft720_sl48_ll192_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 1, 192, 7) (2689, 1, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.33507290482521057, mae:0.37170085310935974
rmse:0.5788547992706299, mape:0.5246615409851074, mspe:276.2716064453125

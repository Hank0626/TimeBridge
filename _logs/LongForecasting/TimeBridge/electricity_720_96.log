Args in experiment:
Namespace(revin=True, alpha=0.2, dropout=0.0, attn_dropout=0.1, batch_size=16, is_training=1, model_id='electricity_96', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=96, seasonal_patterns='Monthly', t_layers=1, stable_len=4, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=4, period=24, ratio=1, periods=None, enc_in=321, dec_in=321, c_in=321, sz_row=None, c_out=321, d_model=512, n_heads=32, e_layers=2, d_layers=1, d_ff=512, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=10, embedding_epochs=5, patience=3, pct_start=0.2, learning_rate=0.0005, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : electricity_96_TimeBridge_custom_M_ft720_sl48_ll96_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.7475201
	speed: 0.4556s/iter; left time: 4961.7378s
	iters: 200, epoch: 1 | loss: 0.7080355
	speed: 0.4070s/iter; left time: 4391.9446s
	iters: 300, epoch: 1 | loss: 0.6256317
	speed: 0.3856s/iter; left time: 4122.1325s
	iters: 400, epoch: 1 | loss: 0.6294580
	speed: 0.2905s/iter; left time: 3076.3418s
	iters: 500, epoch: 1 | loss: 0.6247362
	speed: 0.2596s/iter; left time: 2723.6723s
	iters: 600, epoch: 1 | loss: 0.6295663
	speed: 0.2602s/iter; left time: 2703.2806s
	iters: 700, epoch: 1 | loss: 0.6021112
	speed: 0.2585s/iter; left time: 2660.5616s
	iters: 800, epoch: 1 | loss: 0.6493307
	speed: 0.2586s/iter; left time: 2635.2908s
	iters: 900, epoch: 1 | loss: 0.5953112
	speed: 0.2585s/iter; left time: 2608.9837s
	iters: 1000, epoch: 1 | loss: 0.6081083
	speed: 0.2603s/iter; left time: 2600.7912s
Epoch: 1 cost time: 335.15812492370605
Epoch: 1, Steps: 1099 | Train Loss: 0.6728911 Vali Loss: 0.1122965 Test Loss: 0.1331829
Validation loss decreased (inf --> 0.112296).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5815942
	speed: 1.3384s/iter; left time: 13105.5984s
	iters: 200, epoch: 2 | loss: 0.5800084
	speed: 0.2585s/iter; left time: 2505.1803s
	iters: 300, epoch: 2 | loss: 0.6190696
	speed: 0.2587s/iter; left time: 2481.2190s
	iters: 400, epoch: 2 | loss: 0.5976926
	speed: 0.4106s/iter; left time: 3897.7198s
	iters: 500, epoch: 2 | loss: 0.5633608
	speed: 0.4706s/iter; left time: 4419.5389s
	iters: 600, epoch: 2 | loss: 0.6362876
	speed: 0.4335s/iter; left time: 4028.4917s
	iters: 700, epoch: 2 | loss: 0.5819957
	speed: 0.5196s/iter; left time: 4776.5438s
	iters: 800, epoch: 2 | loss: 0.6635700
	speed: 0.4244s/iter; left time: 3858.9391s
	iters: 900, epoch: 2 | loss: 0.5397013
	speed: 0.5294s/iter; left time: 4760.4613s
	iters: 1000, epoch: 2 | loss: 0.5835062
	speed: 0.4081s/iter; left time: 3628.8545s
Epoch: 2 cost time: 449.1216969490051
Epoch: 2, Steps: 1099 | Train Loss: 0.6055210 Vali Loss: 0.1095457 Test Loss: 0.1288192
Validation loss decreased (0.112296 --> 0.109546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5493769
	speed: 3.5868s/iter; left time: 31180.4329s
	iters: 200, epoch: 3 | loss: 0.5463186
	speed: 0.4425s/iter; left time: 3802.1470s
	iters: 300, epoch: 3 | loss: 0.5480614
	speed: 0.5304s/iter; left time: 4504.7266s
	iters: 400, epoch: 3 | loss: 0.5836093
	speed: 0.3819s/iter; left time: 3205.5586s
	iters: 500, epoch: 3 | loss: 0.5898082
	speed: 0.5206s/iter; left time: 4317.1041s
	iters: 600, epoch: 3 | loss: 0.5994949
	speed: 0.4616s/iter; left time: 3781.7748s
	iters: 700, epoch: 3 | loss: 0.5403512
	speed: 0.3855s/iter; left time: 3120.1792s
	iters: 800, epoch: 3 | loss: 0.5298986
	speed: 0.3895s/iter; left time: 3113.1877s
	iters: 900, epoch: 3 | loss: 0.6043139
	speed: 0.4755s/iter; left time: 3752.9598s
	iters: 1000, epoch: 3 | loss: 0.5635806
	speed: 0.4671s/iter; left time: 3640.1141s
Epoch: 3 cost time: 488.21522974967957
Epoch: 3, Steps: 1099 | Train Loss: 0.5812461 Vali Loss: 0.1069867 Test Loss: 0.1267067
Validation loss decreased (0.109546 --> 0.106987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5582947
	speed: 9.1490s/iter; left time: 69477.2367s
	iters: 200, epoch: 4 | loss: 0.5357463
	speed: 0.4653s/iter; left time: 3486.5970s
	iters: 300, epoch: 4 | loss: 0.5538224
	speed: 0.4343s/iter; left time: 3211.4205s
	iters: 400, epoch: 4 | loss: 0.5742342
	speed: 0.5364s/iter; left time: 3912.1951s
	iters: 500, epoch: 4 | loss: 0.5586696
	speed: 0.4161s/iter; left time: 2993.6293s
	iters: 600, epoch: 4 | loss: 0.5735884
	speed: 0.4567s/iter; left time: 3239.5901s
	iters: 700, epoch: 4 | loss: 0.5326246
	speed: 0.5359s/iter; left time: 3748.0817s
	iters: 800, epoch: 4 | loss: 0.5897129
	speed: 0.3804s/iter; left time: 2622.7598s
	iters: 900, epoch: 4 | loss: 0.5794755
	speed: 0.4871s/iter; left time: 3309.0257s
	iters: 1000, epoch: 4 | loss: 0.5346942
	speed: 0.5187s/iter; left time: 3472.0805s
Epoch: 4 cost time: 506.93528842926025
Epoch: 4, Steps: 1099 | Train Loss: 0.5637336 Vali Loss: 0.1058184 Test Loss: 0.1236041
Validation loss decreased (0.106987 --> 0.105818).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5713506
	speed: 2.9440s/iter; left time: 19120.9613s
	iters: 200, epoch: 5 | loss: 0.5431314
	speed: 0.5414s/iter; left time: 3462.3247s
	iters: 300, epoch: 5 | loss: 0.5459579
	speed: 0.4469s/iter; left time: 2813.2914s
	iters: 400, epoch: 5 | loss: 0.5966873
	speed: 0.4472s/iter; left time: 2770.5788s
	iters: 500, epoch: 5 | loss: 0.5530205
	speed: 0.4942s/iter; left time: 3011.9794s
	iters: 600, epoch: 5 | loss: 0.5832839
	speed: 0.4568s/iter; left time: 2738.5120s
	iters: 700, epoch: 5 | loss: 0.5395788
	speed: 0.3767s/iter; left time: 2220.5508s
	iters: 800, epoch: 5 | loss: 0.5425691
	speed: 0.5071s/iter; left time: 2938.7811s
	iters: 900, epoch: 5 | loss: 0.5745691
	speed: 0.5142s/iter; left time: 2928.4488s
	iters: 1000, epoch: 5 | loss: 0.5139076
	speed: 0.4488s/iter; left time: 2510.8265s
Epoch: 5 cost time: 518.3653509616852
Epoch: 5, Steps: 1099 | Train Loss: 0.5533684 Vali Loss: 0.1043068 Test Loss: 0.1224365
Validation loss decreased (0.105818 --> 0.104307).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5224934
	speed: 3.6952s/iter; left time: 19939.2723s
	iters: 200, epoch: 6 | loss: 0.5466937
	speed: 0.4861s/iter; left time: 2574.4607s
	iters: 300, epoch: 6 | loss: 0.5485175
	speed: 0.5320s/iter; left time: 2764.4670s
	iters: 400, epoch: 6 | loss: 0.5936500
	speed: 0.3912s/iter; left time: 1993.6364s
	iters: 500, epoch: 6 | loss: 0.5559267
	speed: 0.5393s/iter; left time: 2694.4460s
	iters: 600, epoch: 6 | loss: 0.5359534
	speed: 0.4410s/iter; left time: 2159.0434s
	iters: 700, epoch: 6 | loss: 0.5325309
	speed: 0.4777s/iter; left time: 2290.8171s
	iters: 800, epoch: 6 | loss: 0.5492867
	speed: 0.4967s/iter; left time: 2332.4997s
	iters: 900, epoch: 6 | loss: 0.5401335
	speed: 0.4137s/iter; left time: 1901.1388s
	iters: 1000, epoch: 6 | loss: 0.5486638
	speed: 0.3800s/iter; left time: 1708.4707s
Epoch: 6 cost time: 504.17709732055664
Epoch: 6, Steps: 1099 | Train Loss: 0.5476989 Vali Loss: 0.1049433 Test Loss: 0.1215784
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.5199258
	speed: 4.1901s/iter; left time: 18004.8721s
	iters: 200, epoch: 7 | loss: 0.5467634
	speed: 0.4329s/iter; left time: 1817.0908s
	iters: 300, epoch: 7 | loss: 0.5554414
	speed: 0.3240s/iter; left time: 1327.2769s
	iters: 400, epoch: 7 | loss: 0.5724962
	speed: 0.2597s/iter; left time: 1037.9051s
	iters: 500, epoch: 7 | loss: 0.5192964
	speed: 0.2589s/iter; left time: 1008.8576s
	iters: 600, epoch: 7 | loss: 0.5571807
	speed: 0.2583s/iter; left time: 980.7430s
	iters: 700, epoch: 7 | loss: 0.5201160
	speed: 0.2587s/iter; left time: 956.5588s
	iters: 800, epoch: 7 | loss: 0.5521836
	speed: 0.2582s/iter; left time: 928.6705s
	iters: 900, epoch: 7 | loss: 0.5248108
	speed: 0.2618s/iter; left time: 915.4319s
	iters: 1000, epoch: 7 | loss: 0.5489734
	speed: 0.2626s/iter; left time: 891.9895s
Epoch: 7 cost time: 337.9775080680847
Epoch: 7, Steps: 1099 | Train Loss: 0.5447291 Vali Loss: 0.1042856 Test Loss: 0.1202589
Validation loss decreased (0.104307 --> 0.104286).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5416644
	speed: 1.8013s/iter; left time: 5760.6478s
	iters: 200, epoch: 8 | loss: 0.5406049
	speed: 0.2619s/iter; left time: 811.4621s
	iters: 300, epoch: 8 | loss: 0.5578057
	speed: 0.2630s/iter; left time: 788.3940s
	iters: 400, epoch: 8 | loss: 0.5360294
	speed: 0.2624s/iter; left time: 760.3967s
	iters: 500, epoch: 8 | loss: 0.5757573
	speed: 0.2743s/iter; left time: 767.5790s
	iters: 600, epoch: 8 | loss: 0.5211381
	speed: 0.2744s/iter; left time: 740.2854s
	iters: 700, epoch: 8 | loss: 0.5576107
	speed: 0.2812s/iter; left time: 730.5401s
	iters: 800, epoch: 8 | loss: 0.5431924
	speed: 0.2727s/iter; left time: 681.2054s
	iters: 900, epoch: 8 | loss: 0.5374442
	speed: 0.2809s/iter; left time: 673.7033s
	iters: 1000, epoch: 8 | loss: 0.5577813
	speed: 0.2721s/iter; left time: 625.2731s
Epoch: 8 cost time: 296.88031554222107
Epoch: 8, Steps: 1099 | Train Loss: 0.5432625 Vali Loss: 0.1040837 Test Loss: 0.1202170
Validation loss decreased (0.104286 --> 0.104084).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5533642
	speed: 1.3257s/iter; left time: 2782.6837s
	iters: 200, epoch: 9 | loss: 0.5373126
	speed: 0.2635s/iter; left time: 526.7610s
	iters: 300, epoch: 9 | loss: 0.5384012
	speed: 0.2632s/iter; left time: 499.7565s
	iters: 400, epoch: 9 | loss: 0.5811990
	speed: 0.2628s/iter; left time: 472.7484s
	iters: 500, epoch: 9 | loss: 0.5346248
	speed: 0.2634s/iter; left time: 447.5622s
	iters: 600, epoch: 9 | loss: 0.5335718
	speed: 0.2614s/iter; left time: 417.9200s
	iters: 700, epoch: 9 | loss: 0.5687096
	speed: 0.2627s/iter; left time: 393.8572s
	iters: 800, epoch: 9 | loss: 0.5542854
	speed: 0.2629s/iter; left time: 367.7687s
	iters: 900, epoch: 9 | loss: 0.5504072
	speed: 0.2613s/iter; left time: 339.4813s
	iters: 1000, epoch: 9 | loss: 0.5615568
	speed: 0.2628s/iter; left time: 315.1257s
Epoch: 9 cost time: 288.7949013710022
Epoch: 9, Steps: 1099 | Train Loss: 0.5425049 Vali Loss: 0.1042421 Test Loss: 0.1204682
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.5655383
	speed: 1.8173s/iter; left time: 1817.3108s
	iters: 200, epoch: 10 | loss: 0.5478022
	speed: 0.2618s/iter; left time: 235.6558s
	iters: 300, epoch: 10 | loss: 0.5652611
	speed: 0.2625s/iter; left time: 209.9602s
	iters: 400, epoch: 10 | loss: 0.5333384
	speed: 0.2620s/iter; left time: 183.3975s
	iters: 500, epoch: 10 | loss: 0.5237576
	speed: 0.2618s/iter; left time: 157.0935s
	iters: 600, epoch: 10 | loss: 0.5170072
	speed: 0.2637s/iter; left time: 131.8385s
	iters: 700, epoch: 10 | loss: 0.5163929
	speed: 0.2604s/iter; left time: 104.1448s
	iters: 800, epoch: 10 | loss: 0.5676929
	speed: 0.2626s/iter; left time: 78.7890s
	iters: 900, epoch: 10 | loss: 0.5204866
	speed: 0.2651s/iter; left time: 53.0134s
	iters: 1000, epoch: 10 | loss: 0.5530534
	speed: 0.2691s/iter; left time: 26.9066s
Epoch: 10 cost time: 291.4608645439148
Epoch: 10, Steps: 1099 | Train Loss: 0.5420934 Vali Loss: 0.1041754 Test Loss: 0.1204358
EarlyStopping counter: 2 out of 3
>>>>>>>testing : electricity_96_TimeBridge_custom_M_ft720_sl48_ll96_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 1, 96, 321) (5165, 1, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.12021711468696594, mae:0.21485699713230133
rmse:0.34672340750694275, mape:0.4169318675994873, mspe:388978.90625

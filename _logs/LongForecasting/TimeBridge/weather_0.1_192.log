Args in experiment:
Namespace(revin=True, alpha=0.1, dropout=0.0, attn_dropout=0.15, batch_size=32, is_training=1, model_id='weather_192', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=192, seasonal_patterns='Monthly', t_layers=1, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=21, dec_in=21, c_in=21, sz_row=None, c_out=21, d_model=128, n_heads=8, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=10, embedding_epochs=5, patience=3, pct_start=0.2, learning_rate=0.0001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : weather_192_TimeBridge_custom_M_ft720_sl48_ll192_pl128_dm8_nh0_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6574486
	speed: 0.0192s/iter; left time: 214.0875s
	iters: 200, epoch: 1 | loss: 0.7261178
	speed: 0.0133s/iter; left time: 147.1824s
	iters: 300, epoch: 1 | loss: 0.5989590
	speed: 0.0118s/iter; left time: 128.9685s
	iters: 400, epoch: 1 | loss: 0.6549399
	speed: 0.0132s/iter; left time: 143.0312s
	iters: 500, epoch: 1 | loss: 0.5641997
	speed: 0.0126s/iter; left time: 135.0864s
	iters: 600, epoch: 1 | loss: 0.6242621
	speed: 0.0134s/iter; left time: 142.8045s
	iters: 700, epoch: 1 | loss: 0.5901482
	speed: 0.0117s/iter; left time: 122.9495s
	iters: 800, epoch: 1 | loss: 0.6096244
	speed: 0.0127s/iter; left time: 132.8645s
	iters: 900, epoch: 1 | loss: 0.6183617
	speed: 0.0134s/iter; left time: 138.3581s
	iters: 1000, epoch: 1 | loss: 0.5946840
	speed: 0.0122s/iter; left time: 125.3708s
	iters: 1100, epoch: 1 | loss: 0.7056612
	speed: 0.0119s/iter; left time: 120.8623s
Epoch: 1 cost time: 14.848274230957031
Epoch: 1, Steps: 1124 | Train Loss: 0.6290951 Vali Loss: 0.4493204 Test Loss: 0.1924410
Validation loss decreased (inf --> 0.449320).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6148400
	speed: 0.3653s/iter; left time: 3659.0499s
	iters: 200, epoch: 2 | loss: 0.6365329
	speed: 0.0121s/iter; left time: 120.2415s
	iters: 300, epoch: 2 | loss: 0.6832161
	speed: 0.0120s/iter; left time: 117.4030s
	iters: 400, epoch: 2 | loss: 0.6116283
	speed: 0.0132s/iter; left time: 128.2575s
	iters: 500, epoch: 2 | loss: 0.5412405
	speed: 0.0118s/iter; left time: 113.8349s
	iters: 600, epoch: 2 | loss: 0.6176277
	speed: 0.0117s/iter; left time: 110.9102s
	iters: 700, epoch: 2 | loss: 0.6402608
	speed: 0.0117s/iter; left time: 109.8258s
	iters: 800, epoch: 2 | loss: 0.5493246
	speed: 0.0110s/iter; left time: 102.1936s
	iters: 900, epoch: 2 | loss: 0.5409037
	speed: 0.0113s/iter; left time: 104.1191s
	iters: 1000, epoch: 2 | loss: 0.5418669
	speed: 0.0113s/iter; left time: 102.8674s
	iters: 1100, epoch: 2 | loss: 0.5516032
	speed: 0.0122s/iter; left time: 110.1983s
Epoch: 2 cost time: 13.735085248947144
Epoch: 2, Steps: 1124 | Train Loss: 0.5899239 Vali Loss: 0.4456841 Test Loss: 0.1868749
Validation loss decreased (0.449320 --> 0.445684).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5473520
	speed: 0.3689s/iter; left time: 3280.3740s
	iters: 200, epoch: 3 | loss: 0.5902764
	speed: 0.0134s/iter; left time: 117.7972s
	iters: 300, epoch: 3 | loss: 0.5702947
	speed: 0.0118s/iter; left time: 102.7890s
	iters: 400, epoch: 3 | loss: 0.6035217
	speed: 0.0117s/iter; left time: 100.3906s
	iters: 500, epoch: 3 | loss: 0.5493117
	speed: 0.0112s/iter; left time: 95.4915s
	iters: 600, epoch: 3 | loss: 0.5577676
	speed: 0.0120s/iter; left time: 100.6593s
	iters: 700, epoch: 3 | loss: 0.6097698
	speed: 0.0139s/iter; left time: 115.2808s
	iters: 800, epoch: 3 | loss: 0.6233872
	speed: 0.0134s/iter; left time: 109.5253s
	iters: 900, epoch: 3 | loss: 0.5432540
	speed: 0.0126s/iter; left time: 101.9602s
	iters: 1000, epoch: 3 | loss: 0.5785877
	speed: 0.0143s/iter; left time: 114.4400s
	iters: 1100, epoch: 3 | loss: 0.6482077
	speed: 0.0116s/iter; left time: 91.1727s
Epoch: 3 cost time: 14.261232376098633
Epoch: 3, Steps: 1124 | Train Loss: 0.5820425 Vali Loss: 0.4449509 Test Loss: 0.1861216
Validation loss decreased (0.445684 --> 0.444951).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5532058
	speed: 0.3622s/iter; left time: 2813.8018s
	iters: 200, epoch: 4 | loss: 0.5448734
	speed: 0.0134s/iter; left time: 102.6705s
	iters: 300, epoch: 4 | loss: 0.5296175
	speed: 0.0123s/iter; left time: 92.9240s
	iters: 400, epoch: 4 | loss: 0.5609154
	speed: 0.0115s/iter; left time: 86.0428s
	iters: 500, epoch: 4 | loss: 0.6105078
	speed: 0.0128s/iter; left time: 94.0665s
	iters: 600, epoch: 4 | loss: 0.5820594
	speed: 0.0117s/iter; left time: 84.7999s
	iters: 700, epoch: 4 | loss: 0.6292531
	speed: 0.0117s/iter; left time: 84.2321s
	iters: 800, epoch: 4 | loss: 0.6114334
	speed: 0.0120s/iter; left time: 84.9328s
	iters: 900, epoch: 4 | loss: 0.5858960
	speed: 0.0114s/iter; left time: 79.1740s
	iters: 1000, epoch: 4 | loss: 0.6205755
	speed: 0.0117s/iter; left time: 80.3578s
	iters: 1100, epoch: 4 | loss: 0.6623903
	speed: 0.0122s/iter; left time: 82.5592s
Epoch: 4 cost time: 13.888740539550781
Epoch: 4, Steps: 1124 | Train Loss: 0.5788271 Vali Loss: 0.4422307 Test Loss: 0.1856317
Validation loss decreased (0.444951 --> 0.442231).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6087004
	speed: 0.3621s/iter; left time: 2406.2786s
	iters: 200, epoch: 5 | loss: 0.6575855
	speed: 0.0133s/iter; left time: 87.2581s
	iters: 300, epoch: 5 | loss: 0.5777912
	speed: 0.0122s/iter; left time: 78.4392s
	iters: 400, epoch: 5 | loss: 0.5646689
	speed: 0.0121s/iter; left time: 76.8176s
	iters: 500, epoch: 5 | loss: 0.5534597
	speed: 0.0114s/iter; left time: 70.9494s
	iters: 600, epoch: 5 | loss: 0.5326443
	speed: 0.0109s/iter; left time: 67.0454s
	iters: 700, epoch: 5 | loss: 0.5704328
	speed: 0.0106s/iter; left time: 63.9213s
	iters: 800, epoch: 5 | loss: 0.5446617
	speed: 0.0115s/iter; left time: 68.0729s
	iters: 900, epoch: 5 | loss: 0.5884583
	speed: 0.0117s/iter; left time: 68.1880s
	iters: 1000, epoch: 5 | loss: 0.5714730
	speed: 0.0124s/iter; left time: 71.2805s
	iters: 1100, epoch: 5 | loss: 0.5783783
	speed: 0.0121s/iter; left time: 68.5809s
Epoch: 5 cost time: 13.650998592376709
Epoch: 5, Steps: 1124 | Train Loss: 0.5774609 Vali Loss: 0.4438897 Test Loss: 0.1852238
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.6601696
	speed: 0.3652s/iter; left time: 2016.3530s
	iters: 200, epoch: 6 | loss: 0.5323089
	speed: 0.0126s/iter; left time: 68.1345s
	iters: 300, epoch: 6 | loss: 0.5310352
	speed: 0.0147s/iter; left time: 78.2725s
	iters: 400, epoch: 6 | loss: 0.5871887
	speed: 0.0124s/iter; left time: 64.9576s
	iters: 500, epoch: 6 | loss: 0.5362921
	speed: 0.0125s/iter; left time: 63.9893s
	iters: 600, epoch: 6 | loss: 0.6245744
	speed: 0.0115s/iter; left time: 57.7649s
	iters: 700, epoch: 6 | loss: 0.6284170
	speed: 0.0127s/iter; left time: 62.3582s
	iters: 800, epoch: 6 | loss: 0.6007580
	speed: 0.0108s/iter; left time: 52.2919s
	iters: 900, epoch: 6 | loss: 0.5955778
	speed: 0.0120s/iter; left time: 56.5155s
	iters: 1000, epoch: 6 | loss: 0.6254178
	speed: 0.0119s/iter; left time: 54.9057s
	iters: 1100, epoch: 6 | loss: 0.6081840
	speed: 0.0116s/iter; left time: 52.3082s
Epoch: 6 cost time: 14.097184181213379
Epoch: 6, Steps: 1124 | Train Loss: 0.5767046 Vali Loss: 0.4446621 Test Loss: 0.1854390
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.5602545
	speed: 0.3656s/iter; left time: 1607.3698s
	iters: 200, epoch: 7 | loss: 0.5911791
	speed: 0.0129s/iter; left time: 55.2656s
	iters: 300, epoch: 7 | loss: 0.5113001
	speed: 0.0120s/iter; left time: 50.4028s
	iters: 400, epoch: 7 | loss: 0.5273700
	speed: 0.0124s/iter; left time: 50.7099s
	iters: 500, epoch: 7 | loss: 0.5396019
	speed: 0.0113s/iter; left time: 45.0668s
	iters: 600, epoch: 7 | loss: 0.6236041
	speed: 0.0125s/iter; left time: 48.8140s
	iters: 700, epoch: 7 | loss: 0.5601801
	speed: 0.0118s/iter; left time: 44.9452s
	iters: 800, epoch: 7 | loss: 0.5713061
	speed: 0.0130s/iter; left time: 47.8904s
	iters: 900, epoch: 7 | loss: 0.6380384
	speed: 0.0117s/iter; left time: 42.0688s
	iters: 1000, epoch: 7 | loss: 0.5984553
	speed: 0.0123s/iter; left time: 43.1135s
	iters: 1100, epoch: 7 | loss: 0.5718516
	speed: 0.0118s/iter; left time: 40.1516s
Epoch: 7 cost time: 13.835556030273438
Epoch: 7, Steps: 1124 | Train Loss: 0.5762689 Vali Loss: 0.4440524 Test Loss: 0.1853262
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_TimeBridge_custom_M_ft720_sl48_ll192_pl128_dm8_nh0_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 1, 192, 21) (10348, 1, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.18563143908977509, mae:0.22483912110328674
rmse:0.43084967136383057, mape:0.5037157535552979, mspe:16446239.0

Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='traffic_192', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=192, seasonal_patterns='Monthly', t_layers=1, stable_len=2, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=8, period=24, ratio=1, periods=None, enc_in=862, dec_in=862, c_in=862, sz_row=None, c_out=862, d_model=512, n_heads=64, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=5, pct_start=0.2, learning_rate=0.001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : traffic_192_TimeBridge_custom_M_ft720_sl48_ll192_pl512_dm64_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 2.5496895
	speed: 0.6569s/iter; left time: 46574.4308s
	iters: 200, epoch: 1 | loss: 2.1148505
	speed: 0.6383s/iter; left time: 45193.6337s
	iters: 300, epoch: 1 | loss: 1.9033512
	speed: 0.6380s/iter; left time: 45104.6326s
	iters: 400, epoch: 1 | loss: 1.7965592
	speed: 0.6399s/iter; left time: 45174.5224s
	iters: 500, epoch: 1 | loss: 1.8019069
	speed: 0.6377s/iter; left time: 44958.4487s
	iters: 600, epoch: 1 | loss: 1.8424326
	speed: 0.6378s/iter; left time: 44905.2605s
	iters: 700, epoch: 1 | loss: 1.7769872
	speed: 0.6391s/iter; left time: 44932.0313s
Epoch: 1 cost time: 455.20247316360474
Epoch: 1, Steps: 710 | Train Loss: 2.0957942 Vali Loss: 0.3424287 Test Loss: 0.4069879
Validation loss decreased (inf --> 0.342429).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7701391
	speed: 2.2151s/iter; left time: 155478.9117s
	iters: 200, epoch: 2 | loss: 1.7216949
	speed: 0.6351s/iter; left time: 44515.9975s
	iters: 300, epoch: 2 | loss: 1.8660988
	speed: 0.6337s/iter; left time: 44352.5337s
	iters: 400, epoch: 2 | loss: 1.6938500
	speed: 0.6331s/iter; left time: 44251.1501s
	iters: 500, epoch: 2 | loss: 1.6438372
	speed: 0.6336s/iter; left time: 44216.7054s
	iters: 600, epoch: 2 | loss: 1.6841152
	speed: 0.6333s/iter; left time: 44136.0232s
	iters: 700, epoch: 2 | loss: 1.7288995
	speed: 0.6332s/iter; left time: 44066.4617s
Epoch: 2 cost time: 450.8401494026184
Epoch: 2, Steps: 710 | Train Loss: 1.7400033 Vali Loss: 0.3319156 Test Loss: 0.3913091
Validation loss decreased (0.342429 --> 0.331916).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6230798
	speed: 2.2552s/iter; left time: 156691.9092s
	iters: 200, epoch: 3 | loss: 1.5970742
	speed: 0.6329s/iter; left time: 43914.2216s
	iters: 300, epoch: 3 | loss: 1.6869081
	speed: 0.6338s/iter; left time: 43908.8534s
	iters: 400, epoch: 3 | loss: 1.6686262
	speed: 0.6345s/iter; left time: 43895.2320s
	iters: 500, epoch: 3 | loss: 1.7131150
	speed: 0.6337s/iter; left time: 43778.7638s
	iters: 600, epoch: 3 | loss: 1.7409275
	speed: 0.6346s/iter; left time: 43775.4841s
	iters: 700, epoch: 3 | loss: 1.6267760
	speed: 0.6343s/iter; left time: 43689.4670s
Epoch: 3 cost time: 451.1841881275177
Epoch: 3, Steps: 710 | Train Loss: 1.6756780 Vali Loss: 0.3288047 Test Loss: 0.3779446
Validation loss decreased (0.331916 --> 0.328805).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6493198
	speed: 2.2430s/iter; left time: 154253.2336s
	iters: 200, epoch: 4 | loss: 1.6538501
	speed: 0.6334s/iter; left time: 43496.6156s
	iters: 300, epoch: 4 | loss: 1.7332835
	speed: 0.6358s/iter; left time: 43599.0710s
	iters: 400, epoch: 4 | loss: 1.6979741
	speed: 0.6329s/iter; left time: 43338.0197s
	iters: 500, epoch: 4 | loss: 1.5833585
	speed: 0.6332s/iter; left time: 43290.1778s
	iters: 600, epoch: 4 | loss: 1.6200808
	speed: 0.6324s/iter; left time: 43174.4207s
	iters: 700, epoch: 4 | loss: 1.6400011
	speed: 0.6331s/iter; left time: 43157.9267s
Epoch: 4 cost time: 450.52094650268555
Epoch: 4, Steps: 710 | Train Loss: 1.6492273 Vali Loss: 0.3254880 Test Loss: 0.3684256
Validation loss decreased (0.328805 --> 0.325488).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7099442
	speed: 2.1655s/iter; left time: 147389.2085s
	iters: 200, epoch: 5 | loss: 1.6032507
	speed: 0.6338s/iter; left time: 43074.6016s
	iters: 300, epoch: 5 | loss: 1.5800376
	speed: 0.6326s/iter; left time: 42926.9154s
	iters: 400, epoch: 5 | loss: 1.6787697
	speed: 0.6334s/iter; left time: 42919.2230s
	iters: 500, epoch: 5 | loss: 1.6569612
	speed: 0.6340s/iter; left time: 42897.2507s
	iters: 600, epoch: 5 | loss: 1.6463279
	speed: 0.6349s/iter; left time: 42895.4183s
	iters: 700, epoch: 5 | loss: 1.6923338
	speed: 0.6332s/iter; left time: 42714.7812s
Epoch: 5 cost time: 450.8221364021301
Epoch: 5, Steps: 710 | Train Loss: 1.6293490 Vali Loss: 0.3237668 Test Loss: 0.3579322
Validation loss decreased (0.325488 --> 0.323767).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6883177
	speed: 2.2136s/iter; left time: 149088.5300s
	iters: 200, epoch: 6 | loss: 1.6317660
	speed: 0.6329s/iter; left time: 42561.1623s
	iters: 300, epoch: 6 | loss: 1.6168197
	speed: 0.6344s/iter; left time: 42600.2533s
	iters: 400, epoch: 6 | loss: 1.7529389
	speed: 0.6346s/iter; left time: 42553.3091s
	iters: 500, epoch: 6 | loss: 1.6300858
	speed: 0.6337s/iter; left time: 42424.7496s
	iters: 600, epoch: 6 | loss: 1.6087749
	speed: 0.6331s/iter; left time: 42324.4971s
	iters: 700, epoch: 6 | loss: 1.5697278
	speed: 0.6342s/iter; left time: 42333.8716s
Epoch: 6 cost time: 450.617094039917
Epoch: 6, Steps: 710 | Train Loss: 1.6115899 Vali Loss: 0.3207497 Test Loss: 0.3509640
Validation loss decreased (0.323767 --> 0.320750).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5941776
	speed: 2.2352s/iter; left time: 148957.3151s
	iters: 200, epoch: 7 | loss: 1.6315368
	speed: 0.6348s/iter; left time: 42240.2771s
	iters: 300, epoch: 7 | loss: 1.6540773
	speed: 0.6340s/iter; left time: 42124.3589s
	iters: 400, epoch: 7 | loss: 1.6069911
	speed: 0.6334s/iter; left time: 42019.5857s
	iters: 500, epoch: 7 | loss: 1.6393087
	speed: 0.6327s/iter; left time: 41910.7454s
	iters: 600, epoch: 7 | loss: 1.6652578
	speed: 0.6340s/iter; left time: 41930.2057s
	iters: 700, epoch: 7 | loss: 1.6553783
	speed: 0.6339s/iter; left time: 41863.3130s
Epoch: 7 cost time: 450.9201352596283
Epoch: 7, Steps: 710 | Train Loss: 1.6007522 Vali Loss: 0.3194650 Test Loss: 0.3482998
Validation loss decreased (0.320750 --> 0.319465).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6274807
	speed: 2.2290s/iter; left time: 146958.1153s
	iters: 200, epoch: 8 | loss: 1.5299729
	speed: 0.6323s/iter; left time: 41622.6898s
	iters: 300, epoch: 8 | loss: 1.5173490
	speed: 0.6337s/iter; left time: 41651.9576s
	iters: 400, epoch: 8 | loss: 1.6742448
	speed: 0.6348s/iter; left time: 41664.7507s
	iters: 500, epoch: 8 | loss: 1.5960584
	speed: 0.6347s/iter; left time: 41590.4773s
	iters: 600, epoch: 8 | loss: 1.6105355
	speed: 0.6322s/iter; left time: 41367.5669s
	iters: 700, epoch: 8 | loss: 1.5504340
	speed: 0.6332s/iter; left time: 41365.5763s
Epoch: 8 cost time: 450.6849021911621
Epoch: 8, Steps: 710 | Train Loss: 1.5941787 Vali Loss: 0.3185300 Test Loss: 0.3469512
Validation loss decreased (0.319465 --> 0.318530).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5420603
	speed: 2.1855s/iter; left time: 142541.5036s
	iters: 200, epoch: 9 | loss: 1.5906043
	speed: 0.6362s/iter; left time: 41429.0284s
	iters: 300, epoch: 9 | loss: 1.5580590
	speed: 0.6354s/iter; left time: 41312.2137s
	iters: 400, epoch: 9 | loss: 1.5596696
	speed: 0.6343s/iter; left time: 41177.7391s
	iters: 500, epoch: 9 | loss: 1.5426118
	speed: 0.6332s/iter; left time: 41046.9328s
	iters: 600, epoch: 9 | loss: 1.5492567
	speed: 0.6338s/iter; left time: 41020.2152s
	iters: 700, epoch: 9 | loss: 1.5832855
	speed: 0.6360s/iter; left time: 41101.0362s
Epoch: 9 cost time: 451.38129925727844
Epoch: 9, Steps: 710 | Train Loss: 1.5909570 Vali Loss: 0.3180988 Test Loss: 0.3459073
Validation loss decreased (0.318530 --> 0.318099).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5357405
	speed: 2.1575s/iter; left time: 139183.6424s
	iters: 200, epoch: 10 | loss: 1.5242952
	speed: 0.6333s/iter; left time: 40792.8518s
	iters: 300, epoch: 10 | loss: 1.5559889
	speed: 0.6331s/iter; left time: 40715.5730s
	iters: 400, epoch: 10 | loss: 1.6421303
	speed: 0.6343s/iter; left time: 40726.4963s
	iters: 500, epoch: 10 | loss: 1.5347195
	speed: 0.6326s/iter; left time: 40557.3929s
	iters: 600, epoch: 10 | loss: 1.5762157
	speed: 0.6336s/iter; left time: 40557.0651s
	iters: 700, epoch: 10 | loss: 1.6136131
	speed: 0.6350s/iter; left time: 40583.8624s
Epoch: 10 cost time: 450.92076110839844
Epoch: 10, Steps: 710 | Train Loss: 1.5891993 Vali Loss: 0.3184222 Test Loss: 0.3456996
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 1.6321926
	speed: 2.1734s/iter; left time: 138666.6615s
	iters: 200, epoch: 11 | loss: 1.5222881
	speed: 0.6369s/iter; left time: 40573.9625s
	iters: 300, epoch: 11 | loss: 1.5357308
	speed: 0.6343s/iter; left time: 40343.5904s
	iters: 400, epoch: 11 | loss: 1.5827107
	speed: 0.6331s/iter; left time: 40203.3563s
	iters: 500, epoch: 11 | loss: 1.6230236
	speed: 0.6329s/iter; left time: 40124.2562s
	iters: 600, epoch: 11 | loss: 1.5201007
	speed: 0.6335s/iter; left time: 40103.8691s
	iters: 700, epoch: 11 | loss: 1.5951151
	speed: 0.6351s/iter; left time: 40139.3235s
Epoch: 11 cost time: 451.2282168865204
Epoch: 11, Steps: 710 | Train Loss: 1.5882052 Vali Loss: 0.3184595 Test Loss: 0.3455350
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 1.6028600
	speed: 2.2279s/iter; left time: 140560.5303s
	iters: 200, epoch: 12 | loss: 1.5470766
	speed: 0.6335s/iter; left time: 39907.8031s
	iters: 300, epoch: 12 | loss: 1.6180447
	speed: 0.6358s/iter; left time: 39983.7015s
	iters: 400, epoch: 12 | loss: 1.6772383
	speed: 0.6350s/iter; left time: 39872.5353s
	iters: 500, epoch: 12 | loss: 1.5731553
	speed: 0.6356s/iter; left time: 39843.8250s
	iters: 600, epoch: 12 | loss: 1.5361955
	speed: 0.6352s/iter; left time: 39756.9866s
	iters: 700, epoch: 12 | loss: 1.5960047
	speed: 0.6342s/iter; left time: 39628.6721s
Epoch: 12 cost time: 451.5214161872864
Epoch: 12, Steps: 710 | Train Loss: 1.5877042 Vali Loss: 0.3183867 Test Loss: 0.3456937
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 1.6361680
	speed: 2.2214s/iter; left time: 138574.8833s
	iters: 200, epoch: 13 | loss: 1.6403624
	speed: 0.6343s/iter; left time: 39507.8460s
	iters: 300, epoch: 13 | loss: 1.6333373
	speed: 0.6356s/iter; left time: 39524.7002s
	iters: 400, epoch: 13 | loss: 1.6086828
	speed: 0.6350s/iter; left time: 39422.3392s
	iters: 500, epoch: 13 | loss: 1.6051812
	speed: 0.6343s/iter; left time: 39312.2849s
	iters: 600, epoch: 13 | loss: 1.6123962
	speed: 0.6351s/iter; left time: 39298.0387s
	iters: 700, epoch: 13 | loss: 1.5588639
	speed: 0.6347s/iter; left time: 39212.5407s
Epoch: 13 cost time: 451.7060923576355
Epoch: 13, Steps: 710 | Train Loss: 1.5874364 Vali Loss: 0.3180101 Test Loss: 0.3455460
Validation loss decreased (0.318099 --> 0.318010).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6230216
	speed: 2.2653s/iter; left time: 139704.8516s
	iters: 200, epoch: 14 | loss: 1.6678685
	speed: 0.6339s/iter; left time: 39027.7940s
	iters: 300, epoch: 14 | loss: 1.6403990
	speed: 0.6352s/iter; left time: 39043.7142s
	iters: 400, epoch: 14 | loss: 1.6168528
	speed: 0.6342s/iter; left time: 38919.1465s
	iters: 500, epoch: 14 | loss: 1.5861748
	speed: 0.6350s/iter; left time: 38907.9071s
	iters: 600, epoch: 14 | loss: 1.6139519
	speed: 0.6377s/iter; left time: 39009.4020s
	iters: 700, epoch: 14 | loss: 1.5624068
	speed: 0.6340s/iter; left time: 38718.0589s
Epoch: 14 cost time: 451.9926609992981
Epoch: 14, Steps: 710 | Train Loss: 1.5873396 Vali Loss: 0.3180243 Test Loss: 0.3455403
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 15 | loss: 1.5670459
	speed: 2.2574s/iter; left time: 137611.4342s
	iters: 200, epoch: 15 | loss: 1.5597732
	speed: 0.6347s/iter; left time: 38627.5881s
	iters: 300, epoch: 15 | loss: 1.6180018
	speed: 0.6354s/iter; left time: 38608.9440s
	iters: 400, epoch: 15 | loss: 1.6652514
	speed: 0.6349s/iter; left time: 38510.9650s
	iters: 500, epoch: 15 | loss: 1.5395741
	speed: 0.6353s/iter; left time: 38472.4055s
	iters: 600, epoch: 15 | loss: 1.5305196
	speed: 0.6356s/iter; left time: 38431.0726s
	iters: 700, epoch: 15 | loss: 1.6382834
	speed: 0.6351s/iter; left time: 38338.0938s
Epoch: 15 cost time: 451.5631489753723
Epoch: 15, Steps: 710 | Train Loss: 1.5872515 Vali Loss: 0.3182582 Test Loss: 0.3455462
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 16 | loss: 1.5214446
	speed: 2.2484s/iter; left time: 135468.1191s
	iters: 200, epoch: 16 | loss: 1.6357404
	speed: 0.6354s/iter; left time: 38219.8856s
	iters: 300, epoch: 16 | loss: 1.7092662
	speed: 0.6343s/iter; left time: 38090.2573s
	iters: 400, epoch: 16 | loss: 1.6099104
	speed: 0.6351s/iter; left time: 38074.1074s
	iters: 500, epoch: 16 | loss: 1.5782700
	speed: 0.6345s/iter; left time: 37974.8974s
	iters: 600, epoch: 16 | loss: 1.6088415
	speed: 0.6337s/iter; left time: 37866.4469s
	iters: 700, epoch: 16 | loss: 1.6040919
	speed: 0.6351s/iter; left time: 37886.6131s
Epoch: 16 cost time: 451.6947567462921
Epoch: 16, Steps: 710 | Train Loss: 1.5872201 Vali Loss: 0.3183312 Test Loss: 0.3455541
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 17 | loss: 1.5769479
	speed: 2.1938s/iter; left time: 130620.6864s
	iters: 200, epoch: 17 | loss: 1.6245598
	speed: 0.6355s/iter; left time: 37774.2690s
	iters: 300, epoch: 17 | loss: 1.6125596
	speed: 0.6348s/iter; left time: 37666.9877s
	iters: 400, epoch: 17 | loss: 1.7501516
	speed: 0.6344s/iter; left time: 37581.7629s
	iters: 500, epoch: 17 | loss: 1.5799985
	speed: 0.6350s/iter; left time: 37555.5858s
	iters: 600, epoch: 17 | loss: 1.4781905
	speed: 0.6343s/iter; left time: 37449.0854s
	iters: 700, epoch: 17 | loss: 1.5328561
	speed: 0.6344s/iter; left time: 37391.4928s
Epoch: 17 cost time: 451.62839126586914
Epoch: 17, Steps: 710 | Train Loss: 1.5872051 Vali Loss: 0.3183851 Test Loss: 0.3455561
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 18 | loss: 1.5982292
	speed: 2.2426s/iter; left time: 131935.5192s
	iters: 200, epoch: 18 | loss: 1.5542152
	speed: 0.6343s/iter; left time: 37255.4080s
	iters: 300, epoch: 18 | loss: 1.5355698
	speed: 0.6332s/iter; left time: 37125.5680s
	iters: 400, epoch: 18 | loss: 1.5890682
	speed: 0.6330s/iter; left time: 37048.8836s
	iters: 500, epoch: 18 | loss: 1.6083580
	speed: 0.6345s/iter; left time: 37074.8943s
	iters: 600, epoch: 18 | loss: 1.7393148
	speed: 0.6352s/iter; left time: 37053.6814s
	iters: 700, epoch: 18 | loss: 1.5972164
	speed: 0.6353s/iter; left time: 36994.9326s
Epoch: 18 cost time: 451.0318720340729
Epoch: 18, Steps: 710 | Train Loss: 1.5871879 Vali Loss: 0.3182511 Test Loss: 0.3455552
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_192_TimeBridge_custom_M_ft720_sl48_ll192_pl512_dm64_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 1, 192, 862) (3317, 1, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.345543771982193, mae:0.23944209516048431
rmse:0.5878297090530396, mape:0.41631266474723816, mspe:102374.015625

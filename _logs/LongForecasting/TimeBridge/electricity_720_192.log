Args in experiment:
Namespace(revin=True, alpha=0.2, dropout=0.0, attn_dropout=0.1, batch_size=16, is_training=1, model_id='electricity_192', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=192, seasonal_patterns='Monthly', t_layers=1, stable_len=4, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=4, period=24, ratio=1, periods=None, enc_in=321, dec_in=321, c_in=321, sz_row=None, c_out=321, d_model=512, n_heads=32, e_layers=2, d_layers=1, d_ff=512, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=10, embedding_epochs=5, patience=3, pct_start=0.2, learning_rate=0.0005, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : electricity_192_TimeBridge_custom_M_ft720_sl48_ll192_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 1.0342708
	speed: 0.2633s/iter; left time: 2851.3591s
	iters: 200, epoch: 1 | loss: 0.9800791
	speed: 0.2619s/iter; left time: 2810.2039s
	iters: 300, epoch: 1 | loss: 0.8984115
	speed: 0.2625s/iter; left time: 2791.1436s
	iters: 400, epoch: 1 | loss: 0.8490580
	speed: 0.2624s/iter; left time: 2763.8463s
	iters: 500, epoch: 1 | loss: 0.8320099
	speed: 0.2625s/iter; left time: 2738.0349s
	iters: 600, epoch: 1 | loss: 0.8848945
	speed: 0.2622s/iter; left time: 2709.2073s
	iters: 700, epoch: 1 | loss: 0.9073802
	speed: 0.2632s/iter; left time: 2692.4079s
	iters: 800, epoch: 1 | loss: 0.8181025
	speed: 0.2616s/iter; left time: 2650.2661s
	iters: 900, epoch: 1 | loss: 0.8479543
	speed: 0.2631s/iter; left time: 2638.7184s
	iters: 1000, epoch: 1 | loss: 0.8959564
	speed: 0.2619s/iter; left time: 2600.7689s
Epoch: 1 cost time: 286.96923780441284
Epoch: 1, Steps: 1093 | Train Loss: 0.8908740 Vali Loss: 0.1275930 Test Loss: 0.1519745
Validation loss decreased (inf --> 0.127593).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8117074
	speed: 2.3614s/iter; left time: 22995.5950s
	iters: 200, epoch: 2 | loss: 0.7953181
	speed: 0.2616s/iter; left time: 2521.2959s
	iters: 300, epoch: 2 | loss: 0.7760364
	speed: 0.2629s/iter; left time: 2507.4569s
	iters: 400, epoch: 2 | loss: 0.7999579
	speed: 0.2624s/iter; left time: 2476.1977s
	iters: 500, epoch: 2 | loss: 0.7559363
	speed: 0.2628s/iter; left time: 2453.7737s
	iters: 600, epoch: 2 | loss: 0.8180304
	speed: 0.2635s/iter; left time: 2433.8516s
	iters: 700, epoch: 2 | loss: 0.7852403
	speed: 0.2641s/iter; left time: 2413.3368s
	iters: 800, epoch: 2 | loss: 0.8135895
	speed: 0.2812s/iter; left time: 2541.3339s
	iters: 900, epoch: 2 | loss: 0.7903679
	speed: 0.2735s/iter; left time: 2444.8849s
	iters: 1000, epoch: 2 | loss: 0.7839057
	speed: 0.2794s/iter; left time: 2469.2141s
Epoch: 2 cost time: 293.43182277679443
Epoch: 2, Steps: 1093 | Train Loss: 0.8079608 Vali Loss: 0.1257965 Test Loss: 0.1503727
Validation loss decreased (0.127593 --> 0.125797).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7519885
	speed: 3.3033s/iter; left time: 28556.7718s
	iters: 200, epoch: 3 | loss: 0.7676535
	speed: 0.2629s/iter; left time: 2246.8382s
	iters: 300, epoch: 3 | loss: 0.7657984
	speed: 0.2615s/iter; left time: 2207.9590s
	iters: 400, epoch: 3 | loss: 0.7698636
	speed: 0.2634s/iter; left time: 2198.1077s
	iters: 500, epoch: 3 | loss: 0.8143640
	speed: 0.2615s/iter; left time: 2155.7756s
	iters: 600, epoch: 3 | loss: 0.7696863
	speed: 0.2638s/iter; left time: 2148.4662s
	iters: 700, epoch: 3 | loss: 0.7368106
	speed: 0.2619s/iter; left time: 2107.2623s
	iters: 800, epoch: 3 | loss: 0.8001658
	speed: 0.2619s/iter; left time: 2080.4995s
	iters: 900, epoch: 3 | loss: 0.8078921
	speed: 0.2621s/iter; left time: 2056.0926s
	iters: 1000, epoch: 3 | loss: 0.7426175
	speed: 0.2626s/iter; left time: 2034.1275s
Epoch: 3 cost time: 287.2097382545471
Epoch: 3, Steps: 1093 | Train Loss: 0.7766759 Vali Loss: 0.1209829 Test Loss: 0.1442343
Validation loss decreased (0.125797 --> 0.120983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7486711
	speed: 2.2486s/iter; left time: 16981.2941s
	iters: 200, epoch: 4 | loss: 0.7292410
	speed: 0.2627s/iter; left time: 1957.8745s
	iters: 300, epoch: 4 | loss: 0.7638465
	speed: 0.2627s/iter; left time: 1931.0958s
	iters: 400, epoch: 4 | loss: 0.7892188
	speed: 0.2618s/iter; left time: 1898.2834s
	iters: 500, epoch: 4 | loss: 0.7572065
	speed: 0.2627s/iter; left time: 1878.4782s
	iters: 600, epoch: 4 | loss: 0.7813019
	speed: 0.2616s/iter; left time: 1844.7922s
	iters: 700, epoch: 4 | loss: 0.7827454
	speed: 0.2621s/iter; left time: 1822.1211s
	iters: 800, epoch: 4 | loss: 0.8015022
	speed: 0.2618s/iter; left time: 1793.9643s
	iters: 900, epoch: 4 | loss: 0.7222963
	speed: 0.2633s/iter; left time: 1778.1201s
	iters: 1000, epoch: 4 | loss: 0.7863503
	speed: 0.2613s/iter; left time: 1738.4758s
Epoch: 4 cost time: 286.95004391670227
Epoch: 4, Steps: 1093 | Train Loss: 0.7567039 Vali Loss: 0.1203305 Test Loss: 0.1436349
Validation loss decreased (0.120983 --> 0.120330).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7141575
	speed: 2.1044s/iter; left time: 13592.0722s
	iters: 200, epoch: 5 | loss: 0.7266440
	speed: 0.2622s/iter; left time: 1667.1135s
	iters: 300, epoch: 5 | loss: 0.7323027
	speed: 0.2611s/iter; left time: 1634.3128s
	iters: 400, epoch: 5 | loss: 0.7736765
	speed: 0.2620s/iter; left time: 1613.5489s
	iters: 500, epoch: 5 | loss: 0.7244008
	speed: 0.2633s/iter; left time: 1595.0936s
	iters: 600, epoch: 5 | loss: 0.6835943
	speed: 0.2615s/iter; left time: 1558.0512s
	iters: 700, epoch: 5 | loss: 0.7298006
	speed: 0.2628s/iter; left time: 1539.7831s
	iters: 800, epoch: 5 | loss: 0.7367968
	speed: 0.2617s/iter; left time: 1506.9216s
	iters: 900, epoch: 5 | loss: 0.7384835
	speed: 0.2636s/iter; left time: 1491.7335s
	iters: 1000, epoch: 5 | loss: 0.7195530
	speed: 0.2611s/iter; left time: 1451.2349s
Epoch: 5 cost time: 286.7985997200012
Epoch: 5, Steps: 1093 | Train Loss: 0.7450857 Vali Loss: 0.1204193 Test Loss: 0.1422860
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.7598606
	speed: 2.2185s/iter; left time: 11904.6022s
	iters: 200, epoch: 6 | loss: 0.7582105
	speed: 0.2637s/iter; left time: 1388.7721s
	iters: 300, epoch: 6 | loss: 0.7242300
	speed: 0.2614s/iter; left time: 1350.3749s
	iters: 400, epoch: 6 | loss: 0.7295021
	speed: 0.2639s/iter; left time: 1336.8863s
	iters: 500, epoch: 6 | loss: 0.7335517
	speed: 0.2621s/iter; left time: 1301.3752s
	iters: 600, epoch: 6 | loss: 0.7593111
	speed: 0.2642s/iter; left time: 1285.6881s
	iters: 700, epoch: 6 | loss: 0.7196777
	speed: 0.2620s/iter; left time: 1248.7451s
	iters: 800, epoch: 6 | loss: 0.7443826
	speed: 0.2631s/iter; left time: 1227.5102s
	iters: 900, epoch: 6 | loss: 0.7130557
	speed: 0.2628s/iter; left time: 1199.9645s
	iters: 1000, epoch: 6 | loss: 0.7634900
	speed: 0.2612s/iter; left time: 1166.3406s
Epoch: 6 cost time: 287.40671968460083
Epoch: 6, Steps: 1093 | Train Loss: 0.7387911 Vali Loss: 0.1201033 Test Loss: 0.1420187
Validation loss decreased (0.120330 --> 0.120103).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7810735
	speed: 2.1918s/iter; left time: 9365.6807s
	iters: 200, epoch: 7 | loss: 0.7087241
	speed: 0.2620s/iter; left time: 1093.2081s
	iters: 300, epoch: 7 | loss: 0.7677041
	speed: 0.2619s/iter; left time: 1066.6268s
	iters: 400, epoch: 7 | loss: 0.7384420
	speed: 0.2623s/iter; left time: 1042.0660s
	iters: 500, epoch: 7 | loss: 0.7253489
	speed: 0.2623s/iter; left time: 1016.0274s
	iters: 600, epoch: 7 | loss: 0.7353466
	speed: 0.2634s/iter; left time: 993.7950s
	iters: 700, epoch: 7 | loss: 0.7044743
	speed: 0.2626s/iter; left time: 964.3564s
	iters: 800, epoch: 7 | loss: 0.7012474
	speed: 0.2629s/iter; left time: 939.2173s
	iters: 900, epoch: 7 | loss: 0.7356616
	speed: 0.2620s/iter; left time: 909.7759s
	iters: 1000, epoch: 7 | loss: 0.7415896
	speed: 0.2633s/iter; left time: 888.2792s
Epoch: 7 cost time: 287.3129711151123
Epoch: 7, Steps: 1093 | Train Loss: 0.7353074 Vali Loss: 0.1198191 Test Loss: 0.1414290
Validation loss decreased (0.120103 --> 0.119819).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7282648
	speed: 2.2387s/iter; left time: 7119.0270s
	iters: 200, epoch: 8 | loss: 0.7391291
	speed: 0.2619s/iter; left time: 806.7511s
	iters: 300, epoch: 8 | loss: 0.7289495
	speed: 0.2625s/iter; left time: 782.1078s
	iters: 400, epoch: 8 | loss: 0.7058994
	speed: 0.2616s/iter; left time: 753.4977s
	iters: 500, epoch: 8 | loss: 0.7208253
	speed: 0.2626s/iter; left time: 729.9227s
	iters: 600, epoch: 8 | loss: 0.7356149
	speed: 0.2618s/iter; left time: 701.7036s
	iters: 700, epoch: 8 | loss: 0.7290921
	speed: 0.2629s/iter; left time: 678.2496s
	iters: 800, epoch: 8 | loss: 0.7090110
	speed: 0.2615s/iter; left time: 648.4294s
	iters: 900, epoch: 8 | loss: 0.7048575
	speed: 0.2637s/iter; left time: 627.5022s
	iters: 1000, epoch: 8 | loss: 0.7478387
	speed: 0.2625s/iter; left time: 598.5525s
Epoch: 8 cost time: 287.269766330719
Epoch: 8, Steps: 1093 | Train Loss: 0.7335262 Vali Loss: 0.1198743 Test Loss: 0.1410227
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.7269174
	speed: 2.2078s/iter; left time: 4607.7226s
	iters: 200, epoch: 9 | loss: 0.7502495
	speed: 0.2622s/iter; left time: 521.0237s
	iters: 300, epoch: 9 | loss: 0.7476832
	speed: 0.2582s/iter; left time: 487.2499s
	iters: 400, epoch: 9 | loss: 0.7351268
	speed: 0.2584s/iter; left time: 461.7818s
	iters: 500, epoch: 9 | loss: 0.7232395
	speed: 0.2586s/iter; left time: 436.2177s
	iters: 600, epoch: 9 | loss: 0.7597294
	speed: 0.2586s/iter; left time: 410.4000s
	iters: 700, epoch: 9 | loss: 0.6806545
	speed: 0.2600s/iter; left time: 386.5968s
	iters: 800, epoch: 9 | loss: 0.7235581
	speed: 0.2588s/iter; left time: 358.9425s
	iters: 900, epoch: 9 | loss: 0.7468045
	speed: 0.2599s/iter; left time: 334.4947s
	iters: 1000, epoch: 9 | loss: 0.7601247
	speed: 0.2595s/iter; left time: 308.0322s
Epoch: 9 cost time: 284.1386682987213
Epoch: 9, Steps: 1093 | Train Loss: 0.7325826 Vali Loss: 0.1198057 Test Loss: 0.1408248
Validation loss decreased (0.119819 --> 0.119806).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7263132
	speed: 1.6402s/iter; left time: 1630.3271s
	iters: 200, epoch: 10 | loss: 0.7515804
	speed: 0.2588s/iter; left time: 231.3666s
	iters: 300, epoch: 10 | loss: 0.7311008
	speed: 0.2594s/iter; left time: 205.9651s
	iters: 400, epoch: 10 | loss: 0.7515894
	speed: 0.2591s/iter; left time: 179.8322s
	iters: 500, epoch: 10 | loss: 0.7392467
	speed: 0.2588s/iter; left time: 153.7038s
	iters: 600, epoch: 10 | loss: 0.7353970
	speed: 0.2585s/iter; left time: 127.6923s
	iters: 700, epoch: 10 | loss: 0.7317942
	speed: 0.2582s/iter; left time: 101.7121s
	iters: 800, epoch: 10 | loss: 0.7239747
	speed: 0.2587s/iter; left time: 76.0431s
	iters: 900, epoch: 10 | loss: 0.6802524
	speed: 0.2603s/iter; left time: 50.4910s
	iters: 1000, epoch: 10 | loss: 0.7320599
	speed: 0.2630s/iter; left time: 24.7216s
Epoch: 10 cost time: 284.28690338134766
Epoch: 10, Steps: 1093 | Train Loss: 0.7321433 Vali Loss: 0.1196808 Test Loss: 0.1407132
Validation loss decreased (0.119806 --> 0.119681).  Saving model ...
>>>>>>>testing : electricity_192_TimeBridge_custom_M_ft720_sl48_ll192_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 1, 192, 321) (5069, 1, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.14071322977542877, mae:0.23588840663433075
rmse:0.37511762976646423, mape:0.4452727735042572, mspe:674336.5

Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='336', model='TimeBridge', data='ETTh2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=336, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=15, pct_start=0.2, learning_rate=0.0001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 336_TimeBridge_ETTh2_M_ft720_sl48_ll336_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.0490143
	speed: 0.0185s/iter; left time: 873.9268s
	iters: 200, epoch: 1 | loss: 2.0870664
	speed: 0.0121s/iter; left time: 572.2317s
	iters: 300, epoch: 1 | loss: 2.5605714
	speed: 0.0124s/iter; left time: 586.1528s
	iters: 400, epoch: 1 | loss: 2.1404865
	speed: 0.0127s/iter; left time: 596.2734s
Epoch: 1 cost time: 6.498357057571411
Epoch: 1, Steps: 474 | Train Loss: 2.2037702 Vali Loss: 0.4119768 Test Loss: 0.3709251
Validation loss decreased (inf --> 0.411977).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2368033
	speed: 0.1588s/iter; left time: 7438.1100s
	iters: 200, epoch: 2 | loss: 2.4024050
	speed: 0.0129s/iter; left time: 601.0651s
	iters: 300, epoch: 2 | loss: 2.2234275
	speed: 0.0123s/iter; left time: 574.1558s
	iters: 400, epoch: 2 | loss: 2.2547016
	speed: 0.0116s/iter; left time: 539.7124s
Epoch: 2 cost time: 6.0093348026275635
Epoch: 2, Steps: 474 | Train Loss: 2.0686671 Vali Loss: 0.3843601 Test Loss: 0.3717490
Validation loss decreased (0.411977 --> 0.384360).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5091183
	speed: 0.1589s/iter; left time: 7363.2839s
	iters: 200, epoch: 3 | loss: 1.9399478
	speed: 0.0130s/iter; left time: 602.2410s
	iters: 300, epoch: 3 | loss: 1.7659929
	speed: 0.0121s/iter; left time: 560.4117s
	iters: 400, epoch: 3 | loss: 2.4601128
	speed: 0.0113s/iter; left time: 519.6779s
Epoch: 3 cost time: 5.907409429550171
Epoch: 3, Steps: 474 | Train Loss: 2.0184888 Vali Loss: 0.3713386 Test Loss: 0.3687242
Validation loss decreased (0.384360 --> 0.371339).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8730226
	speed: 0.1592s/iter; left time: 7303.4378s
	iters: 200, epoch: 4 | loss: 1.9936881
	speed: 0.0130s/iter; left time: 592.9483s
	iters: 300, epoch: 4 | loss: 1.7569168
	speed: 0.0121s/iter; left time: 554.0314s
	iters: 400, epoch: 4 | loss: 2.1837759
	speed: 0.0130s/iter; left time: 594.1489s
Epoch: 4 cost time: 6.177971363067627
Epoch: 4, Steps: 474 | Train Loss: 1.9992704 Vali Loss: 0.3714374 Test Loss: 0.3700214
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 5 | loss: 1.8626561
	speed: 0.1552s/iter; left time: 7048.9196s
	iters: 200, epoch: 5 | loss: 1.7675484
	speed: 0.0121s/iter; left time: 548.5141s
	iters: 300, epoch: 5 | loss: 1.7023962
	speed: 0.0119s/iter; left time: 537.5111s
	iters: 400, epoch: 5 | loss: 1.7484770
	speed: 0.0120s/iter; left time: 540.4652s
Epoch: 5 cost time: 6.010793209075928
Epoch: 5, Steps: 474 | Train Loss: 1.9898115 Vali Loss: 0.3680706 Test Loss: 0.3679238
Validation loss decreased (0.371339 --> 0.368071).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8224828
	speed: 0.1616s/iter; left time: 7262.9673s
	iters: 200, epoch: 6 | loss: 1.9477391
	speed: 0.0134s/iter; left time: 602.5594s
	iters: 300, epoch: 6 | loss: 1.6663306
	speed: 0.0123s/iter; left time: 552.3054s
	iters: 400, epoch: 6 | loss: 1.5639199
	speed: 0.0120s/iter; left time: 536.6715s
Epoch: 6 cost time: 6.265897512435913
Epoch: 6, Steps: 474 | Train Loss: 1.9855796 Vali Loss: 0.3708129 Test Loss: 0.3675916
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 7 | loss: 2.2233572
	speed: 0.1574s/iter; left time: 6997.1406s
	iters: 200, epoch: 7 | loss: 2.0300136
	speed: 0.0117s/iter; left time: 520.5368s
	iters: 300, epoch: 7 | loss: 1.6561266
	speed: 0.0121s/iter; left time: 537.2070s
	iters: 400, epoch: 7 | loss: 1.9105316
	speed: 0.0115s/iter; left time: 508.9441s
Epoch: 7 cost time: 5.923128604888916
Epoch: 7, Steps: 474 | Train Loss: 1.9834707 Vali Loss: 0.3707020 Test Loss: 0.3674393
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 8 | loss: 1.9139636
	speed: 0.1561s/iter; left time: 6865.6432s
	iters: 200, epoch: 8 | loss: 2.2532721
	speed: 0.0131s/iter; left time: 572.7260s
	iters: 300, epoch: 8 | loss: 2.1057577
	speed: 0.0126s/iter; left time: 550.3460s
	iters: 400, epoch: 8 | loss: 1.8282785
	speed: 0.0123s/iter; left time: 537.5350s
Epoch: 8 cost time: 6.08472752571106
Epoch: 8, Steps: 474 | Train Loss: 1.9821786 Vali Loss: 0.3708232 Test Loss: 0.3671365
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 9 | loss: 1.9980817
	speed: 0.1541s/iter; left time: 6705.6918s
	iters: 200, epoch: 9 | loss: 1.9920678
	speed: 0.0114s/iter; left time: 496.1424s
	iters: 300, epoch: 9 | loss: 1.7481986
	speed: 0.0112s/iter; left time: 483.0659s
	iters: 400, epoch: 9 | loss: 1.6730506
	speed: 0.0121s/iter; left time: 520.9483s
Epoch: 9 cost time: 5.771483421325684
Epoch: 9, Steps: 474 | Train Loss: 1.9817670 Vali Loss: 0.3709348 Test Loss: 0.3671964
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 10 | loss: 2.0097113
	speed: 0.1582s/iter; left time: 6810.1076s
	iters: 200, epoch: 10 | loss: 2.0854263
	speed: 0.0119s/iter; left time: 509.2549s
	iters: 300, epoch: 10 | loss: 2.8642173
	speed: 0.0113s/iter; left time: 485.9156s
	iters: 400, epoch: 10 | loss: 1.8679132
	speed: 0.0118s/iter; left time: 502.8105s
Epoch: 10 cost time: 5.8209357261657715
Epoch: 10, Steps: 474 | Train Loss: 1.9809416 Vali Loss: 0.3713978 Test Loss: 0.3673197
EarlyStopping counter: 5 out of 15
	iters: 100, epoch: 11 | loss: 2.2336311
	speed: 0.1562s/iter; left time: 6646.6008s
	iters: 200, epoch: 11 | loss: 2.3998775
	speed: 0.0127s/iter; left time: 540.2402s
	iters: 300, epoch: 11 | loss: 2.2455363
	speed: 0.0133s/iter; left time: 563.9706s
	iters: 400, epoch: 11 | loss: 2.1304877
	speed: 0.0118s/iter; left time: 498.5030s
Epoch: 11 cost time: 6.099838495254517
Epoch: 11, Steps: 474 | Train Loss: 1.9810071 Vali Loss: 0.3714978 Test Loss: 0.3671923
EarlyStopping counter: 6 out of 15
	iters: 100, epoch: 12 | loss: 1.8437932
	speed: 0.1529s/iter; left time: 6435.4956s
	iters: 200, epoch: 12 | loss: 1.9696368
	speed: 0.0124s/iter; left time: 519.7621s
	iters: 300, epoch: 12 | loss: 1.8595457
	speed: 0.0126s/iter; left time: 529.4554s
	iters: 400, epoch: 12 | loss: 1.6576779
	speed: 0.0121s/iter; left time: 504.6800s
Epoch: 12 cost time: 5.931647777557373
Epoch: 12, Steps: 474 | Train Loss: 1.9808254 Vali Loss: 0.3714754 Test Loss: 0.3671558
EarlyStopping counter: 7 out of 15
	iters: 100, epoch: 13 | loss: 2.3757355
	speed: 0.1554s/iter; left time: 6467.6813s
	iters: 200, epoch: 13 | loss: 1.8030171
	speed: 0.0114s/iter; left time: 472.5810s
	iters: 300, epoch: 13 | loss: 2.4263341
	speed: 0.0125s/iter; left time: 516.3859s
	iters: 400, epoch: 13 | loss: 2.1441903
	speed: 0.0121s/iter; left time: 499.0215s
Epoch: 13 cost time: 5.981320142745972
Epoch: 13, Steps: 474 | Train Loss: 1.9809691 Vali Loss: 0.3709821 Test Loss: 0.3671599
EarlyStopping counter: 8 out of 15
	iters: 100, epoch: 14 | loss: 2.1852176
	speed: 0.1545s/iter; left time: 6356.6724s
	iters: 200, epoch: 14 | loss: 2.1647155
	speed: 0.0118s/iter; left time: 486.2166s
	iters: 300, epoch: 14 | loss: 2.0979018
	speed: 0.0126s/iter; left time: 515.9274s
	iters: 400, epoch: 14 | loss: 1.6132818
	speed: 0.0121s/iter; left time: 492.2900s
Epoch: 14 cost time: 6.058315277099609
Epoch: 14, Steps: 474 | Train Loss: 1.9808590 Vali Loss: 0.3714431 Test Loss: 0.3671561
EarlyStopping counter: 9 out of 15
	iters: 100, epoch: 15 | loss: 2.0495594
	speed: 0.1562s/iter; left time: 6353.2120s
	iters: 200, epoch: 15 | loss: 2.1532440
	speed: 0.0127s/iter; left time: 513.6037s
	iters: 300, epoch: 15 | loss: 1.5938373
	speed: 0.0122s/iter; left time: 493.4610s
	iters: 400, epoch: 15 | loss: 1.8647747
	speed: 0.0117s/iter; left time: 472.0578s
Epoch: 15 cost time: 5.897711277008057
Epoch: 15, Steps: 474 | Train Loss: 1.9807759 Vali Loss: 0.3714048 Test Loss: 0.3671613
EarlyStopping counter: 10 out of 15
	iters: 100, epoch: 16 | loss: 1.9012492
	speed: 0.1539s/iter; left time: 6184.5615s
	iters: 200, epoch: 16 | loss: 2.2746265
	speed: 0.0128s/iter; left time: 514.7252s
	iters: 300, epoch: 16 | loss: 1.7456806
	speed: 0.0123s/iter; left time: 491.7165s
	iters: 400, epoch: 16 | loss: 2.0230312
	speed: 0.0115s/iter; left time: 456.7526s
Epoch: 16 cost time: 6.183867931365967
Epoch: 16, Steps: 474 | Train Loss: 1.9808579 Vali Loss: 0.3713021 Test Loss: 0.3671612
EarlyStopping counter: 11 out of 15
	iters: 100, epoch: 17 | loss: 1.8980443
	speed: 0.1563s/iter; left time: 6208.5759s
	iters: 200, epoch: 17 | loss: 2.1343431
	speed: 0.0121s/iter; left time: 480.7692s
	iters: 300, epoch: 17 | loss: 1.8881605
	speed: 0.0126s/iter; left time: 497.4537s
	iters: 400, epoch: 17 | loss: 1.8609331
	speed: 0.0123s/iter; left time: 482.9707s
Epoch: 17 cost time: 6.045826196670532
Epoch: 17, Steps: 474 | Train Loss: 1.9810606 Vali Loss: 0.3714145 Test Loss: 0.3671614
EarlyStopping counter: 12 out of 15
	iters: 100, epoch: 18 | loss: 1.5606704
	speed: 0.1553s/iter; left time: 6093.7096s
	iters: 200, epoch: 18 | loss: 1.7139426
	speed: 0.0120s/iter; left time: 471.4043s
	iters: 300, epoch: 18 | loss: 2.0890043
	speed: 0.0153s/iter; left time: 597.7581s
	iters: 400, epoch: 18 | loss: 1.6333500
	speed: 0.0126s/iter; left time: 491.2537s
Epoch: 18 cost time: 6.3662919998168945
Epoch: 18, Steps: 474 | Train Loss: 1.9807839 Vali Loss: 0.3713878 Test Loss: 0.3671614
EarlyStopping counter: 13 out of 15
	iters: 100, epoch: 19 | loss: 1.6951067
	speed: 0.1557s/iter; left time: 6034.8558s
	iters: 200, epoch: 19 | loss: 1.8789054
	speed: 0.0145s/iter; left time: 561.7687s
	iters: 300, epoch: 19 | loss: 2.2593598
	speed: 0.0130s/iter; left time: 500.2546s
	iters: 400, epoch: 19 | loss: 1.6328317
	speed: 0.0130s/iter; left time: 499.6955s
Epoch: 19 cost time: 6.697608232498169
Epoch: 19, Steps: 474 | Train Loss: 1.9805431 Vali Loss: 0.3713898 Test Loss: 0.3671614
EarlyStopping counter: 14 out of 15
	iters: 100, epoch: 20 | loss: 1.9395428
	speed: 0.1597s/iter; left time: 6115.2110s
	iters: 200, epoch: 20 | loss: 1.7340348
	speed: 0.0122s/iter; left time: 466.0679s
	iters: 300, epoch: 20 | loss: 2.1863561
	speed: 0.0139s/iter; left time: 527.7286s
	iters: 400, epoch: 20 | loss: 1.7268749
	speed: 0.0122s/iter; left time: 465.0278s
Epoch: 20 cost time: 6.1920857429504395
Epoch: 20, Steps: 474 | Train Loss: 1.9810128 Vali Loss: 0.3714131 Test Loss: 0.3671614
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : 336_TimeBridge_ETTh2_M_ft720_sl48_ll336_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.367923766374588, mae:0.4007609188556671
rmse:0.6065672039985657, mape:0.5537666082382202, mspe:387.46173095703125

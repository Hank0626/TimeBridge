Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=64, is_training=1, model_id='720', model='TimeBridge', data='ETTm2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=720, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=64, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=10, pct_start=0.2, learning_rate=0.0002, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='TST', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 720_TimeBridge_ETTm2_M_ft720_sl48_ll720_pl64_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 2.8924391
	speed: 0.0225s/iter; left time: 1161.7562s
	iters: 200, epoch: 1 | loss: 2.9814963
	speed: 0.0163s/iter; left time: 837.7948s
	iters: 300, epoch: 1 | loss: 2.5279627
	speed: 0.0172s/iter; left time: 885.0390s
	iters: 400, epoch: 1 | loss: 2.2723136
	speed: 0.0167s/iter; left time: 856.9334s
	iters: 500, epoch: 1 | loss: 2.2654071
	speed: 0.0183s/iter; left time: 937.6976s
Epoch: 1 cost time: 9.37834358215332
Epoch: 1, Steps: 517 | Train Loss: 2.7237805 Vali Loss: 0.3249747 Test Loss: 0.4173634
Validation loss decreased (inf --> 0.324975).  Saving model ...
Updating learning rate to 9.182147476703614e-06
	iters: 100, epoch: 2 | loss: 2.3295851
	speed: 0.5247s/iter; left time: 26802.0618s
	iters: 200, epoch: 2 | loss: 2.1721370
	speed: 0.0136s/iter; left time: 693.5664s
	iters: 300, epoch: 2 | loss: 2.1046309
	speed: 0.0140s/iter; left time: 712.3289s
	iters: 400, epoch: 2 | loss: 2.2453711
	speed: 0.0140s/iter; left time: 709.3208s
	iters: 500, epoch: 2 | loss: 2.3110232
	speed: 0.0139s/iter; left time: 703.8063s
Epoch: 2 cost time: 7.487879514694214
Epoch: 2, Steps: 517 | Train Loss: 2.2509622 Vali Loss: 0.3227611 Test Loss: 0.4145280
Validation loss decreased (0.324975 --> 0.322761).  Saving model ...
Updating learning rate to 1.2699475893133679e-05
	iters: 100, epoch: 3 | loss: 2.3231852
	speed: 0.5223s/iter; left time: 26409.8382s
	iters: 200, epoch: 3 | loss: 2.2053146
	speed: 0.0142s/iter; left time: 718.6897s
	iters: 300, epoch: 3 | loss: 2.3441000
	speed: 0.0139s/iter; left time: 701.1852s
	iters: 400, epoch: 3 | loss: 2.0459280
	speed: 0.0142s/iter; left time: 715.7501s
	iters: 500, epoch: 3 | loss: 2.2328939
	speed: 0.0140s/iter; left time: 704.3849s
Epoch: 3 cost time: 7.66610860824585
Epoch: 3, Steps: 517 | Train Loss: 2.2127345 Vali Loss: 0.3151249 Test Loss: 0.4062034
Validation loss decreased (0.322761 --> 0.315125).  Saving model ...
Updating learning rate to 1.8465360230285604e-05
	iters: 100, epoch: 4 | loss: 2.1234624
	speed: 0.5368s/iter; left time: 26868.3080s
	iters: 200, epoch: 4 | loss: 2.2566652
	speed: 0.0148s/iter; left time: 741.3025s
	iters: 300, epoch: 4 | loss: 2.1132104
	speed: 0.0152s/iter; left time: 755.5532s
	iters: 400, epoch: 4 | loss: 2.2229517
	speed: 0.0154s/iter; left time: 766.7451s
	iters: 500, epoch: 4 | loss: 2.0664208
	speed: 0.0152s/iter; left time: 753.5973s
Epoch: 4 cost time: 8.058369159698486
Epoch: 4, Steps: 517 | Train Loss: 2.1730416 Vali Loss: 0.2956638 Test Loss: 0.3874410
Validation loss decreased (0.315125 --> 0.295664).  Saving model ...
Updating learning rate to 2.633779787107333e-05
	iters: 100, epoch: 5 | loss: 1.9522119
	speed: 0.5290s/iter; left time: 26204.7908s
	iters: 200, epoch: 5 | loss: 2.1153553
	speed: 0.0148s/iter; left time: 729.2672s
	iters: 300, epoch: 5 | loss: 2.2016797
	speed: 0.0149s/iter; left time: 734.3589s
	iters: 400, epoch: 5 | loss: 2.1448739
	speed: 0.0143s/iter; left time: 703.1054s
	iters: 500, epoch: 5 | loss: 2.0838068
	speed: 0.0143s/iter; left time: 703.0063s
Epoch: 5 cost time: 7.970320224761963
Epoch: 5, Steps: 517 | Train Loss: 2.1326632 Vali Loss: 0.2865680 Test Loss: 0.3788638
Validation loss decreased (0.295664 --> 0.286568).  Saving model ...
Updating learning rate to 3.61229058510685e-05
	iters: 100, epoch: 6 | loss: 2.0323467
	speed: 0.5507s/iter; left time: 26990.7852s
	iters: 200, epoch: 6 | loss: 2.1766319
	speed: 0.0154s/iter; left time: 751.8153s
	iters: 300, epoch: 6 | loss: 2.1389821
	speed: 0.0150s/iter; left time: 733.4801s
	iters: 400, epoch: 6 | loss: 2.0696065
	speed: 0.0152s/iter; left time: 738.9187s
	iters: 500, epoch: 6 | loss: 2.1394382
	speed: 0.0158s/iter; left time: 766.8209s
Epoch: 6 cost time: 8.252838611602783
Epoch: 6, Steps: 517 | Train Loss: 2.1111686 Vali Loss: 0.2815259 Test Loss: 0.3712838
Validation loss decreased (0.286568 --> 0.281526).  Saving model ...
Updating learning rate to 4.7579695822191464e-05
	iters: 100, epoch: 7 | loss: 2.1192155
	speed: 0.5439s/iter; left time: 26376.3337s
	iters: 200, epoch: 7 | loss: 2.0487051
	speed: 0.0138s/iter; left time: 668.9996s
	iters: 300, epoch: 7 | loss: 2.0224512
	speed: 0.0138s/iter; left time: 668.3354s
	iters: 400, epoch: 7 | loss: 2.0417275
	speed: 0.0138s/iter; left time: 664.0924s
	iters: 500, epoch: 7 | loss: 2.1676664
	speed: 0.0142s/iter; left time: 681.8455s
Epoch: 7 cost time: 7.499013423919678
Epoch: 7, Steps: 517 | Train Loss: 2.0891810 Vali Loss: 0.2767845 Test Loss: 0.3604299
Validation loss decreased (0.281526 --> 0.276784).  Saving model ...
Updating learning rate to 6.0426009131202854e-05
	iters: 100, epoch: 8 | loss: 2.1427269
	speed: 0.5315s/iter; left time: 25502.6614s
	iters: 200, epoch: 8 | loss: 2.1264315
	speed: 0.0147s/iter; left time: 704.4072s
	iters: 300, epoch: 8 | loss: 2.0293295
	speed: 0.0142s/iter; left time: 678.1403s
	iters: 400, epoch: 8 | loss: 2.0801919
	speed: 0.0145s/iter; left time: 692.2717s
	iters: 500, epoch: 8 | loss: 2.1851954
	speed: 0.0160s/iter; left time: 759.4931s
Epoch: 8 cost time: 8.0467050075531
Epoch: 8, Steps: 517 | Train Loss: 2.0691523 Vali Loss: 0.2742573 Test Loss: 0.3548158
Validation loss decreased (0.276784 --> 0.274257).  Saving model ...
Updating learning rate to 7.434546584345289e-05
	iters: 100, epoch: 9 | loss: 1.9964994
	speed: 0.5283s/iter; left time: 25077.7248s
	iters: 200, epoch: 9 | loss: 2.1538389
	speed: 0.0137s/iter; left time: 649.9144s
	iters: 300, epoch: 9 | loss: 2.0237770
	speed: 0.0138s/iter; left time: 652.6936s
	iters: 400, epoch: 9 | loss: 1.9004842
	speed: 0.0154s/iter; left time: 725.4292s
	iters: 500, epoch: 9 | loss: 1.9602399
	speed: 0.0147s/iter; left time: 692.6086s
Epoch: 9 cost time: 7.785031080245972
Epoch: 9, Steps: 517 | Train Loss: 2.0551527 Vali Loss: 0.2666107 Test Loss: 0.3507462
Validation loss decreased (0.274257 --> 0.266611).  Saving model ...
Updating learning rate to 8.89952565708276e-05
	iters: 100, epoch: 10 | loss: 1.9324379
	speed: 0.5386s/iter; left time: 25288.0582s
	iters: 200, epoch: 10 | loss: 2.1212113
	speed: 0.0143s/iter; left time: 669.8668s
	iters: 300, epoch: 10 | loss: 1.9316992
	speed: 0.0144s/iter; left time: 674.0191s
	iters: 400, epoch: 10 | loss: 1.9635003
	speed: 0.0142s/iter; left time: 660.9575s
	iters: 500, epoch: 10 | loss: 1.8765721
	speed: 0.0150s/iter; left time: 695.9687s
Epoch: 10 cost time: 7.857024908065796
Epoch: 10, Steps: 517 | Train Loss: 2.0407549 Vali Loss: 0.2686690 Test Loss: 0.3507964
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001040145852061894
	iters: 100, epoch: 11 | loss: 2.0086169
	speed: 0.5358s/iter; left time: 24877.8033s
	iters: 200, epoch: 11 | loss: 2.0762470
	speed: 0.0144s/iter; left time: 668.4144s
	iters: 300, epoch: 11 | loss: 2.0270836
	speed: 0.0139s/iter; left time: 643.8041s
	iters: 400, epoch: 11 | loss: 2.0036459
	speed: 0.0152s/iter; left time: 701.6729s
	iters: 500, epoch: 11 | loss: 2.1642699
	speed: 0.0152s/iter; left time: 701.5173s
Epoch: 11 cost time: 7.834074258804321
Epoch: 11, Steps: 517 | Train Loss: 2.0270343 Vali Loss: 0.2705467 Test Loss: 0.3549713
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00011903355463603673
	iters: 100, epoch: 12 | loss: 2.0157647
	speed: 0.5393s/iter; left time: 24763.5446s
	iters: 200, epoch: 12 | loss: 2.0932820
	speed: 0.0141s/iter; left time: 646.7357s
	iters: 300, epoch: 12 | loss: 1.9652179
	speed: 0.0142s/iter; left time: 648.4855s
	iters: 400, epoch: 12 | loss: 1.9887767
	speed: 0.0141s/iter; left time: 641.2290s
	iters: 500, epoch: 12 | loss: 1.9949604
	speed: 0.0144s/iter; left time: 655.7205s
Epoch: 12 cost time: 7.652203559875488
Epoch: 12, Steps: 517 | Train Loss: 2.0133357 Vali Loss: 0.2666587 Test Loss: 0.3523762
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0001336822765934075
	iters: 100, epoch: 13 | loss: 1.9746054
	speed: 0.5311s/iter; left time: 24109.7679s
	iters: 200, epoch: 13 | loss: 1.9436064
	speed: 0.0141s/iter; left time: 640.4800s
	iters: 300, epoch: 13 | loss: 1.9203293
	speed: 0.0143s/iter; left time: 648.1768s
	iters: 400, epoch: 13 | loss: 2.0859025
	speed: 0.0146s/iter; left time: 659.0109s
	iters: 500, epoch: 13 | loss: 1.9969108
	speed: 0.0146s/iter; left time: 655.8376s
Epoch: 13 cost time: 7.766776084899902
Epoch: 13, Steps: 517 | Train Loss: 2.0014393 Vali Loss: 0.2601840 Test Loss: 0.3482604
Validation loss decreased (0.266611 --> 0.260184).  Saving model ...
Updating learning rate to 0.00014759998129290915
	iters: 100, epoch: 14 | loss: 2.0390599
	speed: 0.5221s/iter; left time: 23431.2945s
	iters: 200, epoch: 14 | loss: 1.9514844
	speed: 0.0137s/iter; left time: 612.8935s
	iters: 300, epoch: 14 | loss: 2.0979869
	speed: 0.0147s/iter; left time: 658.6941s
	iters: 400, epoch: 14 | loss: 1.9105766
	speed: 0.0135s/iter; left time: 603.3726s
	iters: 500, epoch: 14 | loss: 2.0588295
	speed: 0.0139s/iter; left time: 618.5673s
Epoch: 14 cost time: 7.573123216629028
Epoch: 14, Steps: 517 | Train Loss: 1.9903029 Vali Loss: 0.2794388 Test Loss: 0.3612002
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00016044390249512463
	iters: 100, epoch: 15 | loss: 2.0636141
	speed: 0.5319s/iter; left time: 23595.2599s
	iters: 200, epoch: 15 | loss: 1.8947151
	speed: 0.0153s/iter; left time: 677.4173s
	iters: 300, epoch: 15 | loss: 1.9871767
	speed: 0.0140s/iter; left time: 618.2856s
	iters: 400, epoch: 15 | loss: 1.9065056
	speed: 0.0138s/iter; left time: 607.2055s
	iters: 500, epoch: 15 | loss: 2.0285406
	speed: 0.0148s/iter; left time: 648.6747s
Epoch: 15 cost time: 7.917820930480957
Epoch: 15, Steps: 517 | Train Loss: 1.9784542 Vali Loss: 0.2858073 Test Loss: 0.3605546
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00017189771917838355
	iters: 100, epoch: 16 | loss: 2.0214446
	speed: 0.5435s/iter; left time: 23828.3671s
	iters: 200, epoch: 16 | loss: 2.0281072
	speed: 0.0144s/iter; left time: 629.0945s
	iters: 300, epoch: 16 | loss: 1.9388920
	speed: 0.0161s/iter; left time: 702.9466s
	iters: 400, epoch: 16 | loss: 1.8865412
	speed: 0.0140s/iter; left time: 609.5280s
	iters: 500, epoch: 16 | loss: 1.9067426
	speed: 0.0136s/iter; left time: 590.1335s
Epoch: 16 cost time: 7.893489837646484
Epoch: 16, Steps: 517 | Train Loss: 1.9676163 Vali Loss: 0.2805641 Test Loss: 0.3635077
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00018167934591579543
	iters: 100, epoch: 17 | loss: 1.8943352
	speed: 0.5378s/iter; left time: 23300.6841s
	iters: 200, epoch: 17 | loss: 1.9720775
	speed: 0.0150s/iter; left time: 647.5186s
	iters: 300, epoch: 17 | loss: 1.8945428
	speed: 0.0156s/iter; left time: 670.8114s
	iters: 400, epoch: 17 | loss: 1.7916348
	speed: 0.0150s/iter; left time: 646.7498s
	iters: 500, epoch: 17 | loss: 1.9108851
	speed: 0.0145s/iter; left time: 621.6768s
Epoch: 17 cost time: 8.223831415176392
Epoch: 17, Steps: 517 | Train Loss: 1.9568828 Vali Loss: 0.2801251 Test Loss: 0.3607499
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.0001895478800955752
	iters: 100, epoch: 18 | loss: 1.9014879
	speed: 0.5405s/iter; left time: 23139.8139s
	iters: 200, epoch: 18 | loss: 1.8160384
	speed: 0.0156s/iter; left time: 666.9093s
	iters: 300, epoch: 18 | loss: 1.9108849
	speed: 0.0152s/iter; left time: 646.2258s
	iters: 400, epoch: 18 | loss: 1.8261323
	speed: 0.0139s/iter; left time: 592.9312s
	iters: 500, epoch: 18 | loss: 1.9959540
	speed: 0.0140s/iter; left time: 593.8016s
Epoch: 18 cost time: 7.920047283172607
Epoch: 18, Steps: 517 | Train Loss: 1.9464363 Vali Loss: 0.3103604 Test Loss: 0.3801423
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00019530953488801475
	iters: 100, epoch: 19 | loss: 2.0339503
	speed: 0.5374s/iter; left time: 22730.5963s
	iters: 200, epoch: 19 | loss: 1.7608130
	speed: 0.0142s/iter; left time: 600.8572s
	iters: 300, epoch: 19 | loss: 1.7974240
	speed: 0.0142s/iter; left time: 596.8805s
	iters: 400, epoch: 19 | loss: 1.8939207
	speed: 0.0146s/iter; left time: 614.0080s
	iters: 500, epoch: 19 | loss: 1.9816065
	speed: 0.0146s/iter; left time: 610.4404s
Epoch: 19 cost time: 7.7671895027160645
Epoch: 19, Steps: 517 | Train Loss: 1.9373010 Vali Loss: 0.3027056 Test Loss: 0.3724854
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.0001988224118415617
	iters: 100, epoch: 20 | loss: 1.9251453
	speed: 0.5285s/iter; left time: 22078.5794s
	iters: 200, epoch: 20 | loss: 2.0848083
	speed: 0.0148s/iter; left time: 615.4196s
	iters: 300, epoch: 20 | loss: 1.9298313
	speed: 0.0143s/iter; left time: 596.3876s
	iters: 400, epoch: 20 | loss: 1.9742916
	speed: 0.0143s/iter; left time: 593.8813s
	iters: 500, epoch: 20 | loss: 1.7835691
	speed: 0.0136s/iter; left time: 563.9204s
Epoch: 20 cost time: 7.56744122505188
Epoch: 20, Steps: 517 | Train Loss: 1.9283363 Vali Loss: 0.3021048 Test Loss: 0.3635871
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.00019999999971152582
	iters: 100, epoch: 21 | loss: 1.7171156
	speed: 0.5238s/iter; left time: 21611.9152s
	iters: 200, epoch: 21 | loss: 1.8365804
	speed: 0.0147s/iter; left time: 605.8530s
	iters: 300, epoch: 21 | loss: 1.8102328
	speed: 0.0143s/iter; left time: 588.7175s
	iters: 400, epoch: 21 | loss: 1.8099344
	speed: 0.0155s/iter; left time: 635.9147s
	iters: 500, epoch: 21 | loss: 1.8200140
	speed: 0.0139s/iter; left time: 566.7722s
Epoch: 21 cost time: 7.991055250167847
Epoch: 21, Steps: 517 | Train Loss: 1.9199254 Vali Loss: 0.3054960 Test Loss: 0.3702562
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00019992260543855975
	iters: 100, epoch: 22 | loss: 2.1315074
	speed: 0.5290s/iter; left time: 21551.8734s
	iters: 200, epoch: 22 | loss: 2.0323443
	speed: 0.0138s/iter; left time: 561.9636s
	iters: 300, epoch: 22 | loss: 1.9660494
	speed: 0.0145s/iter; left time: 586.6569s
	iters: 400, epoch: 22 | loss: 1.8957226
	speed: 0.0144s/iter; left time: 583.9843s
	iters: 500, epoch: 22 | loss: 1.9823532
	speed: 0.0143s/iter; left time: 577.5085s
Epoch: 22 cost time: 7.72146463394165
Epoch: 22, Steps: 517 | Train Loss: 1.9124280 Vali Loss: 0.3096987 Test Loss: 0.3791305
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.00019969113836731334
	iters: 100, epoch: 23 | loss: 1.8394526
	speed: 0.5330s/iter; left time: 21441.9623s
	iters: 200, epoch: 23 | loss: 1.8682566
	speed: 0.0139s/iter; left time: 557.2149s
	iters: 300, epoch: 23 | loss: 1.7551352
	speed: 0.0137s/iter; left time: 549.5446s
	iters: 400, epoch: 23 | loss: 1.9688779
	speed: 0.0148s/iter; left time: 591.9674s
	iters: 500, epoch: 23 | loss: 1.9687685
	speed: 0.0145s/iter; left time: 577.1634s
Epoch: 23 cost time: 7.709207773208618
Epoch: 23, Steps: 517 | Train Loss: 1.9046134 Vali Loss: 0.3087445 Test Loss: 0.3818592
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 720_TimeBridge_ETTm2_M_ft720_sl48_ll720_pl64_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.3482602536678314, mae:0.3761790990829468
rmse:0.5901358127593994, mape:0.5199798941612244, mspe:254.00326538085938

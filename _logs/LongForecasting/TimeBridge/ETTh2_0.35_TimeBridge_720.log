Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='720', model='TimeBridge', data='ETTh2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=720, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=15, pct_start=0.2, learning_rate=0.0001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 720_TimeBridge_ETTh2_M_ft720_sl48_ll720_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 2.5789275
	speed: 0.0179s/iter; left time: 803.3454s
	iters: 200, epoch: 1 | loss: 3.2177536
	speed: 0.0128s/iter; left time: 574.8240s
	iters: 300, epoch: 1 | loss: 2.9856880
	speed: 0.0134s/iter; left time: 599.0700s
	iters: 400, epoch: 1 | loss: 2.9687071
	speed: 0.0126s/iter; left time: 560.2354s
Epoch: 1 cost time: 6.337756872177124
Epoch: 1, Steps: 450 | Train Loss: 3.2019615 Vali Loss: 0.6900466 Test Loss: 0.4002640
Validation loss decreased (inf --> 0.690047).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8330324
	speed: 0.1403s/iter; left time: 6234.9708s
	iters: 200, epoch: 2 | loss: 2.8445382
	speed: 0.0127s/iter; left time: 562.3421s
	iters: 300, epoch: 2 | loss: 2.6805804
	speed: 0.0122s/iter; left time: 541.6567s
	iters: 400, epoch: 2 | loss: 3.3093343
	speed: 0.0126s/iter; left time: 555.5275s
Epoch: 2 cost time: 5.8900792598724365
Epoch: 2, Steps: 450 | Train Loss: 3.0618104 Vali Loss: 0.6445559 Test Loss: 0.3988092
Validation loss decreased (0.690047 --> 0.644556).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0257463
	speed: 0.1363s/iter; left time: 5998.9785s
	iters: 200, epoch: 3 | loss: 3.5790396
	speed: 0.0119s/iter; left time: 524.5309s
	iters: 300, epoch: 3 | loss: 3.6464572
	speed: 0.0126s/iter; left time: 550.0811s
	iters: 400, epoch: 3 | loss: 2.7341278
	speed: 0.0125s/iter; left time: 546.9049s
Epoch: 3 cost time: 5.833140134811401
Epoch: 3, Steps: 450 | Train Loss: 3.0112497 Vali Loss: 0.6385649 Test Loss: 0.3986618
Validation loss decreased (0.644556 --> 0.638565).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9077029
	speed: 0.1379s/iter; left time: 6007.0577s
	iters: 200, epoch: 4 | loss: 3.3419864
	speed: 0.0134s/iter; left time: 583.2367s
	iters: 300, epoch: 4 | loss: 3.3404145
	speed: 0.0132s/iter; left time: 574.0734s
	iters: 400, epoch: 4 | loss: 2.8476341
	speed: 0.0124s/iter; left time: 536.9301s
Epoch: 4 cost time: 5.982891321182251
Epoch: 4, Steps: 450 | Train Loss: 2.9829847 Vali Loss: 0.6440676 Test Loss: 0.3967012
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 5 | loss: 2.6138949
	speed: 0.1365s/iter; left time: 5884.5298s
	iters: 200, epoch: 5 | loss: 2.8459682
	speed: 0.0124s/iter; left time: 531.1674s
	iters: 300, epoch: 5 | loss: 2.7374220
	speed: 0.0126s/iter; left time: 541.9363s
	iters: 400, epoch: 5 | loss: 3.2626915
	speed: 0.0115s/iter; left time: 490.8657s
Epoch: 5 cost time: 5.862134695053101
Epoch: 5, Steps: 450 | Train Loss: 2.9682753 Vali Loss: 0.6419766 Test Loss: 0.3956807
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 6 | loss: 3.1750426
	speed: 0.1381s/iter; left time: 5890.6264s
	iters: 200, epoch: 6 | loss: 3.0693810
	speed: 0.0128s/iter; left time: 543.1589s
	iters: 300, epoch: 6 | loss: 2.5430150
	speed: 0.0115s/iter; left time: 488.1889s
	iters: 400, epoch: 6 | loss: 2.5467076
	speed: 0.0122s/iter; left time: 515.8943s
Epoch: 6 cost time: 5.607767343521118
Epoch: 6, Steps: 450 | Train Loss: 2.9608704 Vali Loss: 0.6392985 Test Loss: 0.3970546
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 7 | loss: 2.5560763
	speed: 0.1343s/iter; left time: 5668.6488s
	iters: 200, epoch: 7 | loss: 2.5201211
	speed: 0.0123s/iter; left time: 518.0483s
	iters: 300, epoch: 7 | loss: 3.2059507
	speed: 0.0129s/iter; left time: 540.6664s
	iters: 400, epoch: 7 | loss: 2.6272583
	speed: 0.0125s/iter; left time: 524.7355s
Epoch: 7 cost time: 5.7593674659729
Epoch: 7, Steps: 450 | Train Loss: 2.9567659 Vali Loss: 0.6425040 Test Loss: 0.3959225
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 8 | loss: 3.3284481
	speed: 0.1372s/iter; left time: 5728.3473s
	iters: 200, epoch: 8 | loss: 3.2453933
	speed: 0.0124s/iter; left time: 516.1810s
	iters: 300, epoch: 8 | loss: 2.8559330
	speed: 0.0121s/iter; left time: 501.3927s
	iters: 400, epoch: 8 | loss: 3.0206032
	speed: 0.0126s/iter; left time: 521.9899s
Epoch: 8 cost time: 6.079641103744507
Epoch: 8, Steps: 450 | Train Loss: 2.9547568 Vali Loss: 0.6451771 Test Loss: 0.3957667
EarlyStopping counter: 5 out of 15
	iters: 100, epoch: 9 | loss: 3.2455845
	speed: 0.1382s/iter; left time: 5708.8711s
	iters: 200, epoch: 9 | loss: 3.1837647
	speed: 0.0131s/iter; left time: 538.1417s
	iters: 300, epoch: 9 | loss: 3.3616579
	speed: 0.0116s/iter; left time: 477.7483s
	iters: 400, epoch: 9 | loss: 2.8585615
	speed: 0.0124s/iter; left time: 510.4383s
Epoch: 9 cost time: 5.84281849861145
Epoch: 9, Steps: 450 | Train Loss: 2.9533812 Vali Loss: 0.6436490 Test Loss: 0.3960376
EarlyStopping counter: 6 out of 15
	iters: 100, epoch: 10 | loss: 2.5814679
	speed: 0.1365s/iter; left time: 5577.6973s
	iters: 200, epoch: 10 | loss: 2.8228722
	speed: 0.0129s/iter; left time: 525.3694s
	iters: 300, epoch: 10 | loss: 3.7922745
	speed: 0.0129s/iter; left time: 523.1411s
	iters: 400, epoch: 10 | loss: 2.7722788
	speed: 0.0121s/iter; left time: 491.3928s
Epoch: 10 cost time: 5.86407732963562
Epoch: 10, Steps: 450 | Train Loss: 2.9533017 Vali Loss: 0.6444110 Test Loss: 0.3959666
EarlyStopping counter: 7 out of 15
	iters: 100, epoch: 11 | loss: 3.2614233
	speed: 0.1402s/iter; left time: 5663.3655s
	iters: 200, epoch: 11 | loss: 2.8729396
	speed: 0.0119s/iter; left time: 480.4186s
	iters: 300, epoch: 11 | loss: 2.8793705
	speed: 0.0125s/iter; left time: 503.1536s
	iters: 400, epoch: 11 | loss: 2.9979515
	speed: 0.0125s/iter; left time: 500.6236s
Epoch: 11 cost time: 5.759630441665649
Epoch: 11, Steps: 450 | Train Loss: 2.9527684 Vali Loss: 0.6438184 Test Loss: 0.3959734
EarlyStopping counter: 8 out of 15
	iters: 100, epoch: 12 | loss: 2.6068544
	speed: 0.1338s/iter; left time: 5345.2175s
	iters: 200, epoch: 12 | loss: 2.6203551
	speed: 0.0127s/iter; left time: 506.9648s
	iters: 300, epoch: 12 | loss: 2.8651597
	speed: 0.0127s/iter; left time: 504.2822s
	iters: 400, epoch: 12 | loss: 2.8698421
	speed: 0.0136s/iter; left time: 537.7511s
Epoch: 12 cost time: 6.015169620513916
Epoch: 12, Steps: 450 | Train Loss: 2.9529812 Vali Loss: 0.6444206 Test Loss: 0.3959988
EarlyStopping counter: 9 out of 15
	iters: 100, epoch: 13 | loss: 2.5348382
	speed: 0.1402s/iter; left time: 5539.2649s
	iters: 200, epoch: 13 | loss: 2.6456072
	speed: 0.0143s/iter; left time: 565.2096s
	iters: 300, epoch: 13 | loss: 2.6032357
	speed: 0.0127s/iter; left time: 500.4281s
	iters: 400, epoch: 13 | loss: 2.8100243
	speed: 0.0128s/iter; left time: 500.2622s
Epoch: 13 cost time: 6.491157054901123
Epoch: 13, Steps: 450 | Train Loss: 2.9525089 Vali Loss: 0.6445217 Test Loss: 0.3960264
EarlyStopping counter: 10 out of 15
	iters: 100, epoch: 14 | loss: 2.6854684
	speed: 0.1399s/iter; left time: 5463.2149s
	iters: 200, epoch: 14 | loss: 3.2495484
	speed: 0.0124s/iter; left time: 482.2875s
	iters: 300, epoch: 14 | loss: 2.6535263
	speed: 0.0121s/iter; left time: 471.4700s
	iters: 400, epoch: 14 | loss: 2.7136242
	speed: 0.0142s/iter; left time: 551.8454s
Epoch: 14 cost time: 5.998704433441162
Epoch: 14, Steps: 450 | Train Loss: 2.9529912 Vali Loss: 0.6445795 Test Loss: 0.3960292
EarlyStopping counter: 11 out of 15
	iters: 100, epoch: 15 | loss: 2.8946691
	speed: 0.1366s/iter; left time: 5270.9739s
	iters: 200, epoch: 15 | loss: 3.9171836
	speed: 0.0121s/iter; left time: 464.5856s
	iters: 300, epoch: 15 | loss: 3.0514193
	speed: 0.0118s/iter; left time: 454.7263s
	iters: 400, epoch: 15 | loss: 2.3924549
	speed: 0.0120s/iter; left time: 457.8835s
Epoch: 15 cost time: 5.664591550827026
Epoch: 15, Steps: 450 | Train Loss: 2.9528803 Vali Loss: 0.6443172 Test Loss: 0.3960293
EarlyStopping counter: 12 out of 15
	iters: 100, epoch: 16 | loss: 2.6492314
	speed: 0.1352s/iter; left time: 5157.3570s
	iters: 200, epoch: 16 | loss: 2.9049621
	speed: 0.0121s/iter; left time: 460.7816s
	iters: 300, epoch: 16 | loss: 2.6662183
	speed: 0.0127s/iter; left time: 483.7173s
	iters: 400, epoch: 16 | loss: 2.5499859
	speed: 0.0129s/iter; left time: 486.9663s
Epoch: 16 cost time: 5.962305545806885
Epoch: 16, Steps: 450 | Train Loss: 2.9526881 Vali Loss: 0.6444855 Test Loss: 0.3960297
EarlyStopping counter: 13 out of 15
	iters: 100, epoch: 17 | loss: 3.4488831
	speed: 0.1365s/iter; left time: 5147.2920s
	iters: 200, epoch: 17 | loss: 2.8196714
	speed: 0.0116s/iter; left time: 437.6152s
	iters: 300, epoch: 17 | loss: 2.9121797
	speed: 0.0123s/iter; left time: 461.0033s
	iters: 400, epoch: 17 | loss: 2.5593002
	speed: 0.0132s/iter; left time: 491.8786s
Epoch: 17 cost time: 6.053499698638916
Epoch: 17, Steps: 450 | Train Loss: 2.9526522 Vali Loss: 0.6438739 Test Loss: 0.3960302
EarlyStopping counter: 14 out of 15
	iters: 100, epoch: 18 | loss: 3.5039926
	speed: 0.1382s/iter; left time: 5148.3098s
	iters: 200, epoch: 18 | loss: 2.5529509
	speed: 0.0123s/iter; left time: 455.4991s
	iters: 300, epoch: 18 | loss: 3.2262964
	speed: 0.0122s/iter; left time: 452.4473s
	iters: 400, epoch: 18 | loss: 2.7257094
	speed: 0.0121s/iter; left time: 446.5552s
Epoch: 18 cost time: 5.812453508377075
Epoch: 18, Steps: 450 | Train Loss: 2.9529022 Vali Loss: 0.6443291 Test Loss: 0.3960302
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : 720_TimeBridge_ETTh2_M_ft720_sl48_ll720_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 1, 720, 7) (2161, 1, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.39866188168525696, mae:0.4319058954715729
rmse:0.6313967704772949, mape:0.6157996654510498, mspe:575.8365478515625

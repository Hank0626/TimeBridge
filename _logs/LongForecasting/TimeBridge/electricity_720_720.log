Args in experiment:
Namespace(revin=True, alpha=0.2, dropout=0.0, attn_dropout=0.1, batch_size=16, is_training=1, model_id='electricity_720', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=720, seasonal_patterns='Monthly', t_layers=1, stable_len=4, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=4, period=24, ratio=1, periods=None, enc_in=321, dec_in=321, c_in=321, sz_row=None, c_out=321, d_model=512, n_heads=32, e_layers=2, d_layers=1, d_ff=512, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=10, embedding_epochs=5, patience=3, pct_start=0.2, learning_rate=0.0005, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : electricity_720_TimeBridge_custom_M_ft720_sl48_ll720_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16973
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 1.8574548
	speed: 0.2687s/iter; left time: 2821.7946s
	iters: 200, epoch: 1 | loss: 1.7405332
	speed: 0.2635s/iter; left time: 2740.6367s
	iters: 300, epoch: 1 | loss: 1.6421108
	speed: 0.2649s/iter; left time: 2728.4860s
	iters: 400, epoch: 1 | loss: 1.5575864
	speed: 0.2637s/iter; left time: 2689.9468s
	iters: 500, epoch: 1 | loss: 1.5405812
	speed: 0.2637s/iter; left time: 2663.6892s
	iters: 600, epoch: 1 | loss: 1.5774002
	speed: 0.2628s/iter; left time: 2627.9780s
	iters: 700, epoch: 1 | loss: 1.5266875
	speed: 0.2628s/iter; left time: 2602.1773s
	iters: 800, epoch: 1 | loss: 1.5034256
	speed: 0.2628s/iter; left time: 2575.9374s
	iters: 900, epoch: 1 | loss: 1.5149279
	speed: 0.2631s/iter; left time: 2552.1436s
	iters: 1000, epoch: 1 | loss: 1.4934726
	speed: 0.2636s/iter; left time: 2530.4429s
Epoch: 1 cost time: 279.766978263855
Epoch: 1, Steps: 1060 | Train Loss: 1.6119052 Vali Loss: 0.1730836 Test Loss: 0.2000107
Validation loss decreased (inf --> 0.173084).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4890759
	speed: 1.6217s/iter; left time: 15310.2218s
	iters: 200, epoch: 2 | loss: 1.4662075
	speed: 0.2672s/iter; left time: 2496.2515s
	iters: 300, epoch: 2 | loss: 1.4353371
	speed: 0.2697s/iter; left time: 2492.5507s
	iters: 400, epoch: 2 | loss: 1.4934566
	speed: 0.2667s/iter; left time: 2437.5616s
	iters: 500, epoch: 2 | loss: 1.6221159
	speed: 0.2669s/iter; left time: 2412.8509s
	iters: 600, epoch: 2 | loss: 1.5472947
	speed: 0.2633s/iter; left time: 2353.8761s
	iters: 700, epoch: 2 | loss: 1.4266297
	speed: 0.2629s/iter; left time: 2324.3543s
	iters: 800, epoch: 2 | loss: 1.5275600
	speed: 0.2625s/iter; left time: 2294.5611s
	iters: 900, epoch: 2 | loss: 1.4402788
	speed: 0.2630s/iter; left time: 2272.6077s
	iters: 1000, epoch: 2 | loss: 1.4023129
	speed: 0.2630s/iter; left time: 2246.5716s
Epoch: 2 cost time: 282.39227652549744
Epoch: 2, Steps: 1060 | Train Loss: 1.4684793 Vali Loss: 0.1588085 Test Loss: 0.1849671
Validation loss decreased (0.173084 --> 0.158808).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4327406
	speed: 1.5439s/iter; left time: 12939.5587s
	iters: 200, epoch: 3 | loss: 1.4026284
	speed: 0.2644s/iter; left time: 2189.7600s
	iters: 300, epoch: 3 | loss: 1.3787386
	speed: 0.2655s/iter; left time: 2172.3320s
	iters: 400, epoch: 3 | loss: 1.4336364
	speed: 0.2657s/iter; left time: 2146.9432s
	iters: 500, epoch: 3 | loss: 1.4331543
	speed: 0.2649s/iter; left time: 2114.4407s
	iters: 600, epoch: 3 | loss: 1.4251919
	speed: 0.2648s/iter; left time: 2086.5079s
	iters: 700, epoch: 3 | loss: 1.4320086
	speed: 0.2639s/iter; left time: 2053.5218s
	iters: 800, epoch: 3 | loss: 1.4182537
	speed: 0.2650s/iter; left time: 2035.2814s
	iters: 900, epoch: 3 | loss: 1.4507334
	speed: 0.2661s/iter; left time: 2017.1432s
	iters: 1000, epoch: 3 | loss: 1.3905947
	speed: 0.2643s/iter; left time: 1977.4505s
Epoch: 3 cost time: 281.93422842025757
Epoch: 3, Steps: 1060 | Train Loss: 1.4138268 Vali Loss: 0.1540895 Test Loss: 0.1751713
Validation loss decreased (0.158808 --> 0.154090).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4551443
	speed: 1.6978s/iter; left time: 12429.9107s
	iters: 200, epoch: 4 | loss: 1.3549439
	speed: 0.2642s/iter; left time: 1907.8097s
	iters: 300, epoch: 4 | loss: 1.3842756
	speed: 0.2635s/iter; left time: 1876.5755s
	iters: 400, epoch: 4 | loss: 1.3966181
	speed: 0.2639s/iter; left time: 1852.9303s
	iters: 500, epoch: 4 | loss: 1.3133643
	speed: 0.2635s/iter; left time: 1823.9795s
	iters: 600, epoch: 4 | loss: 1.3612245
	speed: 0.2635s/iter; left time: 1797.3010s
	iters: 700, epoch: 4 | loss: 1.4270151
	speed: 0.2632s/iter; left time: 1768.9835s
	iters: 800, epoch: 4 | loss: 1.3918022
	speed: 0.2640s/iter; left time: 1747.7906s
	iters: 900, epoch: 4 | loss: 1.3983622
	speed: 0.2644s/iter; left time: 1724.3004s
	iters: 1000, epoch: 4 | loss: 1.4269881
	speed: 0.2651s/iter; left time: 1702.5010s
Epoch: 4 cost time: 281.0974085330963
Epoch: 4, Steps: 1060 | Train Loss: 1.3861607 Vali Loss: 0.1534747 Test Loss: 0.1723109
Validation loss decreased (0.154090 --> 0.153475).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3157068
	speed: 1.8920s/iter; left time: 11845.5441s
	iters: 200, epoch: 5 | loss: 1.4182662
	speed: 0.2651s/iter; left time: 1633.2902s
	iters: 300, epoch: 5 | loss: 1.4601159
	speed: 0.2651s/iter; left time: 1606.6918s
	iters: 400, epoch: 5 | loss: 1.4235064
	speed: 0.2657s/iter; left time: 1583.8010s
	iters: 500, epoch: 5 | loss: 1.4081765
	speed: 0.2659s/iter; left time: 1558.6067s
	iters: 600, epoch: 5 | loss: 1.3981402
	speed: 0.2675s/iter; left time: 1540.8944s
	iters: 700, epoch: 5 | loss: 1.4293214
	speed: 0.2663s/iter; left time: 1507.3919s
	iters: 800, epoch: 5 | loss: 1.3419670
	speed: 0.2659s/iter; left time: 1478.6588s
	iters: 900, epoch: 5 | loss: 1.3704447
	speed: 0.2653s/iter; left time: 1448.8453s
	iters: 1000, epoch: 5 | loss: 1.3528968
	speed: 0.2644s/iter; left time: 1417.2465s
Epoch: 5 cost time: 282.8558552265167
Epoch: 5, Steps: 1060 | Train Loss: 1.3708304 Vali Loss: 0.1531695 Test Loss: 0.1716582
Validation loss decreased (0.153475 --> 0.153170).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4354525
	speed: 1.5374s/iter; left time: 7995.7751s
	iters: 200, epoch: 6 | loss: 1.2969418
	speed: 0.2639s/iter; left time: 1345.9539s
	iters: 300, epoch: 6 | loss: 1.3672743
	speed: 0.2631s/iter; left time: 1315.5216s
	iters: 400, epoch: 6 | loss: 1.3606355
	speed: 0.2631s/iter; left time: 1289.6418s
	iters: 500, epoch: 6 | loss: 1.3112909
	speed: 0.2629s/iter; left time: 1262.2243s
	iters: 600, epoch: 6 | loss: 1.3368309
	speed: 0.2626s/iter; left time: 1234.6526s
	iters: 700, epoch: 6 | loss: 1.3061187
	speed: 0.2625s/iter; left time: 1207.5587s
	iters: 800, epoch: 6 | loss: 1.3523836
	speed: 0.2634s/iter; left time: 1185.6699s
	iters: 900, epoch: 6 | loss: 1.3645688
	speed: 0.2630s/iter; left time: 1157.6378s
	iters: 1000, epoch: 6 | loss: 1.3438226
	speed: 0.2634s/iter; left time: 1132.7293s
Epoch: 6 cost time: 280.2210502624512
Epoch: 6, Steps: 1060 | Train Loss: 1.3618257 Vali Loss: 0.1533311 Test Loss: 0.1714986
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 1.3239177
	speed: 1.6056s/iter; left time: 6648.7700s
	iters: 200, epoch: 7 | loss: 1.3299336
	speed: 0.2673s/iter; left time: 1080.2286s
	iters: 300, epoch: 7 | loss: 1.3719391
	speed: 0.2666s/iter; left time: 1050.5133s
	iters: 400, epoch: 7 | loss: 1.3279353
	speed: 0.2667s/iter; left time: 1024.5840s
	iters: 500, epoch: 7 | loss: 1.3411969
	speed: 0.2672s/iter; left time: 999.6173s
	iters: 600, epoch: 7 | loss: 1.3222299
	speed: 0.2667s/iter; left time: 971.1041s
	iters: 700, epoch: 7 | loss: 1.3843246
	speed: 0.2660s/iter; left time: 941.7807s
	iters: 800, epoch: 7 | loss: 1.3405043
	speed: 0.2681s/iter; left time: 922.4214s
	iters: 900, epoch: 7 | loss: 1.3352783
	speed: 0.2665s/iter; left time: 890.3206s
	iters: 1000, epoch: 7 | loss: 1.3122296
	speed: 0.2675s/iter; left time: 867.1076s
Epoch: 7 cost time: 284.2341778278351
Epoch: 7, Steps: 1060 | Train Loss: 1.3569122 Vali Loss: 0.1526307 Test Loss: 0.1717928
Validation loss decreased (0.153170 --> 0.152631).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3330383
	speed: 4.1462s/iter; left time: 12774.5148s
	iters: 200, epoch: 8 | loss: 1.3667855
	speed: 0.8117s/iter; left time: 2419.5490s
	iters: 300, epoch: 8 | loss: 1.3322766
	speed: 0.7508s/iter; left time: 2163.0255s
	iters: 400, epoch: 8 | loss: 1.3449155
	speed: 0.8301s/iter; left time: 2308.6387s
	iters: 500, epoch: 8 | loss: 1.3348875
	speed: 0.7321s/iter; left time: 1962.6704s
	iters: 600, epoch: 8 | loss: 1.3262340
	speed: 0.8297s/iter; left time: 2141.5475s
	iters: 700, epoch: 8 | loss: 1.3667471
	speed: 0.7650s/iter; left time: 1897.8525s
	iters: 800, epoch: 8 | loss: 1.3273405
	speed: 0.8102s/iter; left time: 1928.9831s
	iters: 900, epoch: 8 | loss: 1.3591841
	speed: 0.7978s/iter; left time: 1819.8796s
	iters: 1000, epoch: 8 | loss: 1.3843944
	speed: 0.7638s/iter; left time: 1665.8326s
Epoch: 8 cost time: 840.495817899704
Epoch: 8, Steps: 1060 | Train Loss: 1.3543932 Vali Loss: 0.1525755 Test Loss: 0.1715576
Validation loss decreased (0.152631 --> 0.152576).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3604681
	speed: 9.6895s/iter; left time: 19582.5090s
	iters: 200, epoch: 9 | loss: 1.3447126
	speed: 0.8062s/iter; left time: 1548.7842s
	iters: 300, epoch: 9 | loss: 1.3381597
	speed: 0.8177s/iter; left time: 1489.1068s
	iters: 400, epoch: 9 | loss: 1.3710132
	speed: 0.8181s/iter; left time: 1408.0125s
	iters: 500, epoch: 9 | loss: 1.3382654
	speed: 0.8214s/iter; left time: 1331.4274s
	iters: 600, epoch: 9 | loss: 1.3378137
	speed: 0.8050s/iter; left time: 1224.3913s
	iters: 700, epoch: 9 | loss: 1.3214539
	speed: 0.8266s/iter; left time: 1174.6529s
	iters: 800, epoch: 9 | loss: 1.3634489
	speed: 0.8054s/iter; left time: 1063.9674s
	iters: 900, epoch: 9 | loss: 1.2953095
	speed: 0.8205s/iter; left time: 1001.8395s
	iters: 1000, epoch: 9 | loss: 1.3652468
	speed: 0.8051s/iter; left time: 902.5038s
Epoch: 9 cost time: 849.5853686332703
Epoch: 9, Steps: 1060 | Train Loss: 1.3530336 Vali Loss: 0.1524914 Test Loss: 0.1714565
Validation loss decreased (0.152576 --> 0.152491).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3990586
	speed: 4.9150s/iter; left time: 4723.3290s
	iters: 200, epoch: 10 | loss: 1.4146267
	speed: 0.2662s/iter; left time: 229.2234s
	iters: 300, epoch: 10 | loss: 1.3798808
	speed: 0.2684s/iter; left time: 204.2149s
	iters: 400, epoch: 10 | loss: 1.3577229
	speed: 0.2679s/iter; left time: 177.0512s
	iters: 500, epoch: 10 | loss: 1.3934984
	speed: 0.2683s/iter; left time: 150.5016s
	iters: 600, epoch: 10 | loss: 1.3453832
	speed: 0.2690s/iter; left time: 123.9909s
	iters: 700, epoch: 10 | loss: 1.3563722
	speed: 0.2667s/iter; left time: 96.2831s
	iters: 800, epoch: 10 | loss: 1.3293029
	speed: 0.2673s/iter; left time: 69.7727s
	iters: 900, epoch: 10 | loss: 1.2986096
	speed: 0.4901s/iter; left time: 78.9008s
	iters: 1000, epoch: 10 | loss: 1.3639497
	speed: 0.5138s/iter; left time: 31.3423s
Epoch: 10 cost time: 340.13347363471985
Epoch: 10, Steps: 1060 | Train Loss: 1.3523707 Vali Loss: 0.1523386 Test Loss: 0.1715883
Validation loss decreased (0.152491 --> 0.152339).  Saving model ...
>>>>>>>testing : electricity_720_TimeBridge_custom_M_ft720_sl48_ll720_pl512_dm32_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 1, 720, 321) (4541, 1, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.1715877205133438, mae:0.26568174362182617
rmse:0.41423147916793823, mape:0.48449498414993286, mspe:433792.15625

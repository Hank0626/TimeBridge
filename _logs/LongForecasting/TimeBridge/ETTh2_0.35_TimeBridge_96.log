Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='96', model='TimeBridge', data='ETTh2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=96, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=15, pct_start=0.2, learning_rate=0.0001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 96_TimeBridge_ETTh2_M_ft720_sl48_ll96_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 1.1130288
	speed: 0.0165s/iter; left time: 804.9441s
	iters: 200, epoch: 1 | loss: 1.4410673
	speed: 0.0110s/iter; left time: 533.3838s
	iters: 300, epoch: 1 | loss: 1.1006885
	speed: 0.0125s/iter; left time: 606.7944s
	iters: 400, epoch: 1 | loss: 1.0544496
	speed: 0.0123s/iter; left time: 598.0806s
Epoch: 1 cost time: 6.3468523025512695
Epoch: 1, Steps: 489 | Train Loss: 1.2571029 Vali Loss: 0.2386664 Test Loss: 0.2906807
Validation loss decreased (inf --> 0.238666).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0097646
	speed: 0.1682s/iter; left time: 8127.4563s
	iters: 200, epoch: 2 | loss: 1.4254903
	speed: 0.0118s/iter; left time: 566.5924s
	iters: 300, epoch: 2 | loss: 1.0581086
	speed: 0.0130s/iter; left time: 624.9093s
	iters: 400, epoch: 2 | loss: 1.3190925
	speed: 0.0118s/iter; left time: 566.9888s
Epoch: 2 cost time: 6.0934624671936035
Epoch: 2, Steps: 489 | Train Loss: 1.1420389 Vali Loss: 0.2179465 Test Loss: 0.2732945
Validation loss decreased (0.238666 --> 0.217946).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2167406
	speed: 0.1634s/iter; left time: 7814.4208s
	iters: 200, epoch: 3 | loss: 0.9079612
	speed: 0.0119s/iter; left time: 565.9415s
	iters: 300, epoch: 3 | loss: 1.0127274
	speed: 0.0124s/iter; left time: 591.8023s
	iters: 400, epoch: 3 | loss: 1.0848769
	speed: 0.0115s/iter; left time: 545.4634s
Epoch: 3 cost time: 6.170544624328613
Epoch: 3, Steps: 489 | Train Loss: 1.1094633 Vali Loss: 0.2159716 Test Loss: 0.2702212
Validation loss decreased (0.217946 --> 0.215972).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3358909
	speed: 0.1607s/iter; left time: 7608.2494s
	iters: 200, epoch: 4 | loss: 1.0225599
	speed: 0.0120s/iter; left time: 566.1027s
	iters: 300, epoch: 4 | loss: 1.0665854
	speed: 0.0110s/iter; left time: 520.7804s
	iters: 400, epoch: 4 | loss: 1.2259389
	speed: 0.0112s/iter; left time: 527.8197s
Epoch: 4 cost time: 5.752124786376953
Epoch: 4, Steps: 489 | Train Loss: 1.0967473 Vali Loss: 0.2141314 Test Loss: 0.2685043
Validation loss decreased (0.215972 --> 0.214131).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9382591
	speed: 0.1645s/iter; left time: 7705.8158s
	iters: 200, epoch: 5 | loss: 0.9779810
	speed: 0.0126s/iter; left time: 590.2402s
	iters: 300, epoch: 5 | loss: 1.1916547
	speed: 0.0121s/iter; left time: 566.1005s
	iters: 400, epoch: 5 | loss: 1.0095158
	speed: 0.0114s/iter; left time: 530.9138s
Epoch: 5 cost time: 6.089435338973999
Epoch: 5, Steps: 489 | Train Loss: 1.0912126 Vali Loss: 0.2138549 Test Loss: 0.2681366
Validation loss decreased (0.214131 --> 0.213855).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0096992
	speed: 0.1666s/iter; left time: 7721.7375s
	iters: 200, epoch: 6 | loss: 1.5368388
	speed: 0.0131s/iter; left time: 608.0277s
	iters: 300, epoch: 6 | loss: 1.0468744
	speed: 0.0124s/iter; left time: 573.2852s
	iters: 400, epoch: 6 | loss: 1.0441462
	speed: 0.0122s/iter; left time: 560.7355s
Epoch: 6 cost time: 6.48803186416626
Epoch: 6, Steps: 489 | Train Loss: 1.0884157 Vali Loss: 0.2116681 Test Loss: 0.2675531
Validation loss decreased (0.213855 --> 0.211668).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0127915
	speed: 0.1671s/iter; left time: 7663.5288s
	iters: 200, epoch: 7 | loss: 1.3123949
	speed: 0.0130s/iter; left time: 593.3349s
	iters: 300, epoch: 7 | loss: 0.9090599
	speed: 0.0127s/iter; left time: 577.8702s
	iters: 400, epoch: 7 | loss: 1.1084466
	speed: 0.0129s/iter; left time: 589.6285s
Epoch: 7 cost time: 6.389748811721802
Epoch: 7, Steps: 489 | Train Loss: 1.0868796 Vali Loss: 0.2124828 Test Loss: 0.2672626
EarlyStopping counter: 1 out of 15
	iters: 100, epoch: 8 | loss: 1.1234616
	speed: 0.1720s/iter; left time: 7805.5101s
	iters: 200, epoch: 8 | loss: 1.2608578
	speed: 0.0127s/iter; left time: 576.0686s
	iters: 300, epoch: 8 | loss: 1.0801314
	speed: 0.0124s/iter; left time: 562.1915s
	iters: 400, epoch: 8 | loss: 0.9981052
	speed: 0.0125s/iter; left time: 561.5276s
Epoch: 8 cost time: 6.554460525512695
Epoch: 8, Steps: 489 | Train Loss: 1.0865001 Vali Loss: 0.2119605 Test Loss: 0.2675611
EarlyStopping counter: 2 out of 15
	iters: 100, epoch: 9 | loss: 0.9962382
	speed: 0.1674s/iter; left time: 7513.5712s
	iters: 200, epoch: 9 | loss: 1.0517682
	speed: 0.0119s/iter; left time: 530.8739s
	iters: 300, epoch: 9 | loss: 1.0405777
	speed: 0.0126s/iter; left time: 561.8656s
	iters: 400, epoch: 9 | loss: 1.2137223
	speed: 0.0130s/iter; left time: 580.2568s
Epoch: 9 cost time: 6.36431360244751
Epoch: 9, Steps: 489 | Train Loss: 1.0858476 Vali Loss: 0.2124522 Test Loss: 0.2675785
EarlyStopping counter: 3 out of 15
	iters: 100, epoch: 10 | loss: 0.8617164
	speed: 0.1716s/iter; left time: 7618.7007s
	iters: 200, epoch: 10 | loss: 0.9046967
	speed: 0.0121s/iter; left time: 535.2510s
	iters: 300, epoch: 10 | loss: 1.0819082
	speed: 0.0123s/iter; left time: 545.2126s
	iters: 400, epoch: 10 | loss: 1.0557787
	speed: 0.0126s/iter; left time: 554.4145s
Epoch: 10 cost time: 6.632803916931152
Epoch: 10, Steps: 489 | Train Loss: 1.0857090 Vali Loss: 0.2126621 Test Loss: 0.2675419
EarlyStopping counter: 4 out of 15
	iters: 100, epoch: 11 | loss: 1.2939316
	speed: 0.1671s/iter; left time: 7336.8014s
	iters: 200, epoch: 11 | loss: 1.2889869
	speed: 0.0114s/iter; left time: 497.5375s
	iters: 300, epoch: 11 | loss: 0.8620642
	speed: 0.0124s/iter; left time: 540.3465s
	iters: 400, epoch: 11 | loss: 1.5877956
	speed: 0.0112s/iter; left time: 488.5560s
Epoch: 11 cost time: 5.854540586471558
Epoch: 11, Steps: 489 | Train Loss: 1.0857744 Vali Loss: 0.2124448 Test Loss: 0.2675669
EarlyStopping counter: 5 out of 15
	iters: 100, epoch: 12 | loss: 0.9562504
	speed: 0.1610s/iter; left time: 6989.3380s
	iters: 200, epoch: 12 | loss: 0.9781608
	speed: 0.0118s/iter; left time: 509.6943s
	iters: 300, epoch: 12 | loss: 1.1511798
	speed: 0.0115s/iter; left time: 497.8770s
	iters: 400, epoch: 12 | loss: 1.2896202
	speed: 0.0129s/iter; left time: 554.6656s
Epoch: 12 cost time: 6.036525011062622
Epoch: 12, Steps: 489 | Train Loss: 1.0854877 Vali Loss: 0.2124743 Test Loss: 0.2675504
EarlyStopping counter: 6 out of 15
	iters: 100, epoch: 13 | loss: 0.9560453
	speed: 0.1647s/iter; left time: 7072.3105s
	iters: 200, epoch: 13 | loss: 1.1046413
	speed: 0.0117s/iter; left time: 501.0521s
	iters: 300, epoch: 13 | loss: 0.9963312
	speed: 0.0124s/iter; left time: 530.6190s
	iters: 400, epoch: 13 | loss: 1.0051171
	speed: 0.0124s/iter; left time: 527.1299s
Epoch: 13 cost time: 6.135558843612671
Epoch: 13, Steps: 489 | Train Loss: 1.0854889 Vali Loss: 0.2125152 Test Loss: 0.2675492
EarlyStopping counter: 7 out of 15
	iters: 100, epoch: 14 | loss: 0.9985039
	speed: 0.1635s/iter; left time: 6937.9103s
	iters: 200, epoch: 14 | loss: 1.2188380
	speed: 0.0118s/iter; left time: 500.9662s
	iters: 300, epoch: 14 | loss: 1.1289091
	speed: 0.0117s/iter; left time: 492.4418s
	iters: 400, epoch: 14 | loss: 1.0829722
	speed: 0.0109s/iter; left time: 460.1444s
Epoch: 14 cost time: 5.996607303619385
Epoch: 14, Steps: 489 | Train Loss: 1.0856495 Vali Loss: 0.2124366 Test Loss: 0.2675479
EarlyStopping counter: 8 out of 15
	iters: 100, epoch: 15 | loss: 1.1498171
	speed: 0.1641s/iter; left time: 6885.6761s
	iters: 200, epoch: 15 | loss: 1.0717382
	speed: 0.0136s/iter; left time: 568.3101s
	iters: 300, epoch: 15 | loss: 1.2859524
	speed: 0.0114s/iter; left time: 475.4397s
	iters: 400, epoch: 15 | loss: 1.0022213
	speed: 0.0126s/iter; left time: 524.3178s
Epoch: 15 cost time: 6.381490468978882
Epoch: 15, Steps: 489 | Train Loss: 1.0852856 Vali Loss: 0.2125201 Test Loss: 0.2675459
EarlyStopping counter: 9 out of 15
	iters: 100, epoch: 16 | loss: 0.9766955
	speed: 0.1593s/iter; left time: 6603.8959s
	iters: 200, epoch: 16 | loss: 1.2805600
	speed: 0.0111s/iter; left time: 458.9281s
	iters: 300, epoch: 16 | loss: 0.9812903
	speed: 0.0119s/iter; left time: 489.0558s
	iters: 400, epoch: 16 | loss: 1.3261286
	speed: 0.0132s/iter; left time: 542.7551s
Epoch: 16 cost time: 6.003282308578491
Epoch: 16, Steps: 489 | Train Loss: 1.0855635 Vali Loss: 0.2123518 Test Loss: 0.2675456
EarlyStopping counter: 10 out of 15
	iters: 100, epoch: 17 | loss: 1.1691400
	speed: 0.1604s/iter; left time: 6570.6764s
	iters: 200, epoch: 17 | loss: 1.1967845
	speed: 0.0121s/iter; left time: 492.8553s
	iters: 300, epoch: 17 | loss: 1.0678240
	speed: 0.0127s/iter; left time: 516.8884s
	iters: 400, epoch: 17 | loss: 1.2999483
	speed: 0.0111s/iter; left time: 450.1855s
Epoch: 17 cost time: 6.072554349899292
Epoch: 17, Steps: 489 | Train Loss: 1.0853076 Vali Loss: 0.2125480 Test Loss: 0.2675459
EarlyStopping counter: 11 out of 15
	iters: 100, epoch: 18 | loss: 0.9944189
	speed: 0.1633s/iter; left time: 6610.1882s
	iters: 200, epoch: 18 | loss: 1.2278790
	speed: 0.0121s/iter; left time: 486.7425s
	iters: 300, epoch: 18 | loss: 1.0419676
	speed: 0.0122s/iter; left time: 490.2907s
	iters: 400, epoch: 18 | loss: 1.0052654
	speed: 0.0118s/iter; left time: 475.4786s
Epoch: 18 cost time: 6.414982318878174
Epoch: 18, Steps: 489 | Train Loss: 1.0854698 Vali Loss: 0.2125131 Test Loss: 0.2675457
EarlyStopping counter: 12 out of 15
	iters: 100, epoch: 19 | loss: 1.0292825
	speed: 0.1598s/iter; left time: 6392.2123s
	iters: 200, epoch: 19 | loss: 1.3431170
	speed: 0.0116s/iter; left time: 461.7787s
	iters: 300, epoch: 19 | loss: 1.1487556
	speed: 0.0114s/iter; left time: 453.2473s
	iters: 400, epoch: 19 | loss: 0.9962792
	speed: 0.0115s/iter; left time: 458.2451s
Epoch: 19 cost time: 5.888105630874634
Epoch: 19, Steps: 489 | Train Loss: 1.0856801 Vali Loss: 0.2125083 Test Loss: 0.2675457
EarlyStopping counter: 13 out of 15
	iters: 100, epoch: 20 | loss: 1.3124305
	speed: 0.1709s/iter; left time: 6753.0829s
	iters: 200, epoch: 20 | loss: 0.9291286
	speed: 0.0128s/iter; left time: 505.5655s
	iters: 300, epoch: 20 | loss: 1.0068382
	speed: 0.0108s/iter; left time: 426.4638s
	iters: 400, epoch: 20 | loss: 1.1766996
	speed: 0.0109s/iter; left time: 428.9462s
Epoch: 20 cost time: 6.057247638702393
Epoch: 20, Steps: 489 | Train Loss: 1.0856666 Vali Loss: 0.2125266 Test Loss: 0.2675457
EarlyStopping counter: 14 out of 15
	iters: 100, epoch: 21 | loss: 1.0457286
	speed: 0.1639s/iter; left time: 6394.8379s
	iters: 200, epoch: 21 | loss: 0.9590213
	speed: 0.0115s/iter; left time: 447.5445s
	iters: 300, epoch: 21 | loss: 0.8972452
	speed: 0.0106s/iter; left time: 411.1816s
	iters: 400, epoch: 21 | loss: 1.1696594
	speed: 0.0115s/iter; left time: 443.6280s
Epoch: 21 cost time: 5.733576536178589
Epoch: 21, Steps: 489 | Train Loss: 1.0853853 Vali Loss: 0.2125038 Test Loss: 0.2675457
EarlyStopping counter: 15 out of 15
Early stopping
>>>>>>>testing : 96_TimeBridge_ETTh2_M_ft720_sl48_ll96_pl128_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 1, 96, 7) (2785, 1, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.26755303144454956, mae:0.3286878168582916
rmse:0.5172553062438965, mape:0.4871925413608551, mspe:272.02532958984375

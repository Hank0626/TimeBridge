Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=64, is_training=1, model_id='336', model='TimeBridge', data='ETTm2', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=336, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=48, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=64, n_heads=4, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=10, pct_start=0.2, learning_rate=0.0002, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='TST', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 336_TimeBridge_ETTm2_M_ft720_sl48_ll336_pl64_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 2.0887997
	speed: 0.0217s/iter; left time: 1135.1512s
	iters: 200, epoch: 1 | loss: 2.0274932
	speed: 0.0155s/iter; left time: 807.6082s
	iters: 300, epoch: 1 | loss: 1.8121656
	speed: 0.0136s/iter; left time: 709.6222s
	iters: 400, epoch: 1 | loss: 2.0040126
	speed: 0.0146s/iter; left time: 759.0945s
	iters: 500, epoch: 1 | loss: 1.7470759
	speed: 0.0145s/iter; left time: 751.1632s
Epoch: 1 cost time: 8.374226093292236
Epoch: 1, Steps: 523 | Train Loss: 1.9675248 Vali Loss: 0.2664166 Test Loss: 0.3542498
Validation loss decreased (inf --> 0.266417).  Saving model ...
Updating learning rate to 9.182144858656152e-06
	iters: 100, epoch: 2 | loss: 1.9081883
	speed: 0.5351s/iter; left time: 27655.0023s
	iters: 200, epoch: 2 | loss: 1.7176292
	speed: 0.0145s/iter; left time: 748.3991s
	iters: 300, epoch: 2 | loss: 1.5008180
	speed: 0.0139s/iter; left time: 713.4141s
	iters: 400, epoch: 2 | loss: 1.6650974
	speed: 0.0137s/iter; left time: 705.0398s
	iters: 500, epoch: 2 | loss: 1.6906435
	speed: 0.0139s/iter; left time: 711.7989s
Epoch: 2 cost time: 7.608598470687866
Epoch: 2, Steps: 523 | Train Loss: 1.6241743 Vali Loss: 0.2582248 Test Loss: 0.3459400
Validation loss decreased (0.266417 --> 0.258225).  Saving model ...
Updating learning rate to 1.2699465549898567e-05
	iters: 100, epoch: 3 | loss: 1.5950046
	speed: 0.5372s/iter; left time: 27481.4131s
	iters: 200, epoch: 3 | loss: 1.5375838
	speed: 0.0139s/iter; left time: 711.4354s
	iters: 300, epoch: 3 | loss: 1.5389808
	speed: 0.0136s/iter; left time: 691.3195s
	iters: 400, epoch: 3 | loss: 1.4798809
	speed: 0.0140s/iter; left time: 713.0681s
	iters: 500, epoch: 3 | loss: 1.5012766
	speed: 0.0148s/iter; left time: 752.2152s
Epoch: 3 cost time: 7.535781145095825
Epoch: 3, Steps: 523 | Train Loss: 1.5758456 Vali Loss: 0.2404815 Test Loss: 0.3189676
Validation loss decreased (0.258225 --> 0.240482).  Saving model ...
Updating learning rate to 1.8465337436823174e-05
	iters: 100, epoch: 4 | loss: 1.6945753
	speed: 0.5335s/iter; left time: 27012.7754s
	iters: 200, epoch: 4 | loss: 1.5093029
	speed: 0.0139s/iter; left time: 701.0700s
	iters: 300, epoch: 4 | loss: 1.5714058
	speed: 0.0134s/iter; left time: 673.3168s
	iters: 400, epoch: 4 | loss: 1.4537759
	speed: 0.0135s/iter; left time: 681.8648s
	iters: 500, epoch: 4 | loss: 1.4406786
	speed: 0.0143s/iter; left time: 715.8087s
Epoch: 4 cost time: 7.57056736946106
Epoch: 4, Steps: 523 | Train Loss: 1.5287564 Vali Loss: 0.2280740 Test Loss: 0.3026940
Validation loss decreased (0.240482 --> 0.228074).  Saving model ...
Updating learning rate to 2.6337758523455013e-05
	iters: 100, epoch: 5 | loss: 1.6981678
	speed: 0.5371s/iter; left time: 26912.2213s
	iters: 200, epoch: 5 | loss: 1.4825234
	speed: 0.0139s/iter; left time: 694.9279s
	iters: 300, epoch: 5 | loss: 1.4623692
	speed: 0.0140s/iter; left time: 697.8804s
	iters: 400, epoch: 5 | loss: 1.4996564
	speed: 0.0139s/iter; left time: 691.8282s
	iters: 500, epoch: 5 | loss: 1.4412036
	speed: 0.0149s/iter; left time: 740.8741s
Epoch: 5 cost time: 7.693890571594238
Epoch: 5, Steps: 523 | Train Loss: 1.4996885 Vali Loss: 0.2175070 Test Loss: 0.2913708
Validation loss decreased (0.228074 --> 0.217507).  Saving model ...
Updating learning rate to 3.612284668244535e-05
	iters: 100, epoch: 6 | loss: 1.4612985
	speed: 0.5292s/iter; left time: 26238.8643s
	iters: 200, epoch: 6 | loss: 1.6094416
	speed: 0.0136s/iter; left time: 673.6754s
	iters: 300, epoch: 6 | loss: 1.6001921
	speed: 0.0134s/iter; left time: 663.0014s
	iters: 400, epoch: 6 | loss: 1.3440907
	speed: 0.0135s/iter; left time: 667.4525s
	iters: 500, epoch: 6 | loss: 1.4647751
	speed: 0.0135s/iter; left time: 663.2767s
Epoch: 6 cost time: 7.3999035358428955
Epoch: 6, Steps: 523 | Train Loss: 1.4749699 Vali Loss: 0.2072331 Test Loss: 0.2796241
Validation loss decreased (0.217507 --> 0.207233).  Saving model ...
Updating learning rate to 4.757961458757239e-05
	iters: 100, epoch: 7 | loss: 1.5627398
	speed: 0.5233s/iter; left time: 25676.0559s
	iters: 200, epoch: 7 | loss: 1.4822631
	speed: 0.0139s/iter; left time: 681.0939s
	iters: 300, epoch: 7 | loss: 1.3984631
	speed: 0.0133s/iter; left time: 647.5788s
	iters: 400, epoch: 7 | loss: 1.4210048
	speed: 0.0136s/iter; left time: 660.7530s
	iters: 500, epoch: 7 | loss: 1.3661678
	speed: 0.0135s/iter; left time: 655.7944s
Epoch: 7 cost time: 7.315587282180786
Epoch: 7, Steps: 523 | Train Loss: 1.4532428 Vali Loss: 0.2010175 Test Loss: 0.2732415
Validation loss decreased (0.207233 --> 0.201017).  Saving model ...
Updating learning rate to 6.0425904753922327e-05
	iters: 100, epoch: 8 | loss: 1.2676473
	speed: 0.5225s/iter; left time: 25364.2016s
	iters: 200, epoch: 8 | loss: 1.4785722
	speed: 0.0140s/iter; left time: 677.2476s
	iters: 300, epoch: 8 | loss: 1.5556473
	speed: 0.0138s/iter; left time: 666.2726s
	iters: 400, epoch: 8 | loss: 1.3731722
	speed: 0.0144s/iter; left time: 693.1066s
	iters: 500, epoch: 8 | loss: 1.3120931
	speed: 0.0141s/iter; left time: 680.2856s
Epoch: 8 cost time: 7.620365619659424
Epoch: 8, Steps: 523 | Train Loss: 1.4352631 Vali Loss: 0.1987665 Test Loss: 0.2710579
Validation loss decreased (0.201017 --> 0.198766).  Saving model ...
Updating learning rate to 7.434533851747528e-05
	iters: 100, epoch: 9 | loss: 1.4342734
	speed: 0.5186s/iter; left time: 24899.8721s
	iters: 200, epoch: 9 | loss: 1.4688168
	speed: 0.0139s/iter; left time: 665.3396s
	iters: 300, epoch: 9 | loss: 1.4204146
	speed: 0.0134s/iter; left time: 642.4412s
	iters: 400, epoch: 9 | loss: 1.3934896
	speed: 0.0131s/iter; left time: 624.0343s
	iters: 500, epoch: 9 | loss: 1.4090027
	speed: 0.0130s/iter; left time: 619.6620s
Epoch: 9 cost time: 7.289471626281738
Epoch: 9, Steps: 523 | Train Loss: 1.4202104 Vali Loss: 0.1960415 Test Loss: 0.2680926
Validation loss decreased (0.198766 --> 0.196041).  Saving model ...
Updating learning rate to 8.899510781450224e-05
	iters: 100, epoch: 10 | loss: 1.5443842
	speed: 0.5271s/iter; left time: 25035.2203s
	iters: 200, epoch: 10 | loss: 1.3061802
	speed: 0.0143s/iter; left time: 675.8796s
	iters: 300, epoch: 10 | loss: 1.5645378
	speed: 0.0135s/iter; left time: 640.2768s
	iters: 400, epoch: 10 | loss: 1.3569589
	speed: 0.0141s/iter; left time: 665.6475s
	iters: 500, epoch: 10 | loss: 1.3236691
	speed: 0.0141s/iter; left time: 664.1666s
Epoch: 10 cost time: 7.622766971588135
Epoch: 10, Steps: 523 | Train Loss: 1.4105716 Vali Loss: 0.1938905 Test Loss: 0.2683719
Validation loss decreased (0.196041 --> 0.193890).  Saving model ...
Updating learning rate to 0.00010401441786469121
	iters: 100, epoch: 11 | loss: 1.4111232
	speed: 0.5455s/iter; left time: 25620.5365s
	iters: 200, epoch: 11 | loss: 1.5739051
	speed: 0.0136s/iter; left time: 635.3676s
	iters: 300, epoch: 11 | loss: 1.4289440
	speed: 0.0138s/iter; left time: 644.1928s
	iters: 400, epoch: 11 | loss: 1.3774055
	speed: 0.0136s/iter; left time: 633.2530s
	iters: 500, epoch: 11 | loss: 1.3330078
	speed: 0.0141s/iter; left time: 657.8281s
Epoch: 11 cost time: 7.537832975387573
Epoch: 11, Steps: 523 | Train Loss: 1.4039243 Vali Loss: 0.1926988 Test Loss: 0.2675258
Validation loss decreased (0.193890 --> 0.192699).  Saving model ...
Updating learning rate to 0.00011903337283145066
	iters: 100, epoch: 12 | loss: 1.3811320
	speed: 0.5375s/iter; left time: 24965.3560s
	iters: 200, epoch: 12 | loss: 1.3817592
	speed: 0.0136s/iter; left time: 628.1790s
	iters: 300, epoch: 12 | loss: 1.3263463
	speed: 0.0133s/iter; left time: 616.2181s
	iters: 400, epoch: 12 | loss: 1.4147345
	speed: 0.0135s/iter; left time: 620.7052s
	iters: 500, epoch: 12 | loss: 1.4200422
	speed: 0.0141s/iter; left time: 650.2992s
Epoch: 12 cost time: 7.415017127990723
Epoch: 12, Steps: 523 | Train Loss: 1.3982938 Vali Loss: 0.1937986 Test Loss: 0.2692182
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001336820856231901
	iters: 100, epoch: 13 | loss: 1.5727713
	speed: 0.5259s/iter; left time: 24152.9467s
	iters: 200, epoch: 13 | loss: 1.4443531
	speed: 0.0136s/iter; left time: 622.3934s
	iters: 300, epoch: 13 | loss: 1.3387132
	speed: 0.0134s/iter; left time: 610.4719s
	iters: 400, epoch: 13 | loss: 1.4415241
	speed: 0.0139s/iter; left time: 635.4593s
	iters: 500, epoch: 13 | loss: 1.4093640
	speed: 0.0139s/iter; left time: 630.5484s
Epoch: 13 cost time: 7.638707637786865
Epoch: 13, Steps: 523 | Train Loss: 1.3929341 Vali Loss: 0.1968853 Test Loss: 0.2712515
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00014759978747922863
	iters: 100, epoch: 14 | loss: 1.4283634
	speed: 0.5283s/iter; left time: 23987.0086s
	iters: 200, epoch: 14 | loss: 1.6051779
	speed: 0.0150s/iter; left time: 679.7007s
	iters: 300, epoch: 14 | loss: 1.4702421
	speed: 0.0139s/iter; left time: 627.3313s
	iters: 400, epoch: 14 | loss: 1.4425920
	speed: 0.0129s/iter; left time: 584.0425s
	iters: 500, epoch: 14 | loss: 1.3779228
	speed: 0.0133s/iter; left time: 596.6581s
Epoch: 14 cost time: 7.80848503112793
Epoch: 14, Steps: 523 | Train Loss: 1.3872646 Vali Loss: 0.1984641 Test Loss: 0.2727154
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00016044371298928648
	iters: 100, epoch: 15 | loss: 1.4073048
	speed: 0.5282s/iter; left time: 23704.8784s
	iters: 200, epoch: 15 | loss: 1.3377599
	speed: 0.0137s/iter; left time: 613.2421s
	iters: 300, epoch: 15 | loss: 1.3563714
	speed: 0.0139s/iter; left time: 618.9402s
	iters: 400, epoch: 15 | loss: 1.4573182
	speed: 0.0137s/iter; left time: 609.7422s
	iters: 500, epoch: 15 | loss: 1.3673942
	speed: 0.0134s/iter; left time: 597.2896s
Epoch: 15 cost time: 7.41704249382019
Epoch: 15, Steps: 523 | Train Loss: 1.3810891 Vali Loss: 0.2020121 Test Loss: 0.2750252
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00017189754172614128
	iters: 100, epoch: 16 | loss: 1.4211397
	speed: 0.5210s/iter; left time: 23107.8195s
	iters: 200, epoch: 16 | loss: 1.3897262
	speed: 0.0145s/iter; left time: 641.7239s
	iters: 300, epoch: 16 | loss: 1.3178817
	speed: 0.0137s/iter; left time: 604.7293s
	iters: 400, epoch: 16 | loss: 1.4495491
	speed: 0.0124s/iter; left time: 545.6836s
	iters: 500, epoch: 16 | loss: 1.3425930
	speed: 0.0129s/iter; left time: 568.5897s
Epoch: 16 cost time: 7.34589695930481
Epoch: 16, Steps: 523 | Train Loss: 1.3749579 Vali Loss: 0.1957483 Test Loss: 0.2729813
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.000181679188590768
	iters: 100, epoch: 17 | loss: 1.2789274
	speed: 0.5232s/iter; left time: 22934.8111s
	iters: 200, epoch: 17 | loss: 1.4640672
	speed: 0.0136s/iter; left time: 596.9111s
	iters: 300, epoch: 17 | loss: 1.4800255
	speed: 0.0132s/iter; left time: 574.6564s
	iters: 400, epoch: 17 | loss: 1.4997115
	speed: 0.0135s/iter; left time: 589.4959s
	iters: 500, epoch: 17 | loss: 1.3581139
	speed: 0.0137s/iter; left time: 594.9667s
Epoch: 17 cost time: 7.1823766231536865
Epoch: 17, Steps: 523 | Train Loss: 1.3685298 Vali Loss: 0.2008953 Test Loss: 0.2812360
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00018954775100920394
	iters: 100, epoch: 18 | loss: 1.2805886
	speed: 0.5191s/iter; left time: 22482.0749s
	iters: 200, epoch: 18 | loss: 1.5784719
	speed: 0.0136s/iter; left time: 585.8009s
	iters: 300, epoch: 18 | loss: 1.2959096
	speed: 0.0134s/iter; left time: 576.5263s
	iters: 400, epoch: 18 | loss: 1.3325865
	speed: 0.0133s/iter; left time: 572.6718s
	iters: 500, epoch: 18 | loss: 1.2680396
	speed: 0.0138s/iter; left time: 591.2891s
Epoch: 18 cost time: 7.291910409927368
Epoch: 18, Steps: 523 | Train Loss: 1.3627403 Vali Loss: 0.2049005 Test Loss: 0.2773412
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.00019530944188544976
	iters: 100, epoch: 19 | loss: 1.2613244
	speed: 0.5309s/iter; left time: 22714.2165s
	iters: 200, epoch: 19 | loss: 1.3715110
	speed: 0.0137s/iter; left time: 583.5272s
	iters: 300, epoch: 19 | loss: 1.4767221
	speed: 0.0125s/iter; left time: 533.6811s
	iters: 400, epoch: 19 | loss: 1.3113700
	speed: 0.0128s/iter; left time: 544.3260s
	iters: 500, epoch: 19 | loss: 1.3424094
	speed: 0.0132s/iter; left time: 557.6716s
Epoch: 19 cost time: 7.0701305866241455
Epoch: 19, Steps: 523 | Train Loss: 1.3578794 Vali Loss: 0.2058480 Test Loss: 0.2708520
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00019882236219353631
	iters: 100, epoch: 20 | loss: 1.3381733
	speed: 0.5243s/iter; left time: 22158.2901s
	iters: 200, epoch: 20 | loss: 1.3716065
	speed: 0.0136s/iter; left time: 574.9672s
	iters: 300, epoch: 20 | loss: 1.4213551
	speed: 0.0141s/iter; left time: 591.6124s
	iters: 400, epoch: 20 | loss: 1.3371315
	speed: 0.0144s/iter; left time: 603.0107s
	iters: 500, epoch: 20 | loss: 1.2325647
	speed: 0.0130s/iter; left time: 543.2072s
Epoch: 20 cost time: 7.429892301559448
Epoch: 20, Steps: 523 | Train Loss: 1.3517564 Vali Loss: 0.2079730 Test Loss: 0.2776741
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.00019999999971810677
	iters: 100, epoch: 21 | loss: 1.4637489
	speed: 0.5312s/iter; left time: 22173.1718s
	iters: 200, epoch: 21 | loss: 1.3374900
	speed: 0.0131s/iter; left time: 544.9612s
	iters: 300, epoch: 21 | loss: 1.2349505
	speed: 0.0128s/iter; left time: 531.3295s
	iters: 400, epoch: 21 | loss: 1.3457984
	speed: 0.0130s/iter; left time: 537.4744s
	iters: 500, epoch: 21 | loss: 1.4670655
	speed: 0.0132s/iter; left time: 546.8196s
Epoch: 21 cost time: 7.058058738708496
Epoch: 21, Steps: 523 | Train Loss: 1.3465171 Vali Loss: 0.2112912 Test Loss: 0.2770658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_TimeBridge_ETTm2_M_ft720_sl48_ll336_pl64_dm4_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.2675258219242096, mae:0.3194100260734558
rmse:0.5172289609909058, mape:0.46480897068977356, mspe:203.3037567138672

Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=64, is_training=1, model_id='336', model='TimeBridge', data='ETTh1', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=336, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=24, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=8, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=10, pct_start=0.2, learning_rate=0.0002, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 336_TimeBridge_ETTh1_M_ft720_sl48_ll336_pl128_dm8_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.5515509
	speed: 0.0272s/iter; left time: 317.9007s
Epoch: 1 cost time: 3.063033103942871
Epoch: 1, Steps: 118 | Train Loss: 2.6513620 Vali Loss: 1.2702128 Test Loss: 0.4212104
Validation loss decreased (inf --> 1.270213).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4169495
	speed: 0.1484s/iter; left time: 1718.6441s
Epoch: 2 cost time: 2.477837562561035
Epoch: 2, Steps: 118 | Train Loss: 2.4827665 Vali Loss: 1.2764024 Test Loss: 0.4142333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4906535
	speed: 0.1491s/iter; left time: 1709.0351s
Epoch: 3 cost time: 2.5070183277130127
Epoch: 3, Steps: 118 | Train Loss: 2.4451047 Vali Loss: 1.2763929 Test Loss: 0.4082229
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3922911
	speed: 0.1473s/iter; left time: 1671.5984s
Epoch: 4 cost time: 2.4346401691436768
Epoch: 4, Steps: 118 | Train Loss: 2.4291422 Vali Loss: 1.2757502 Test Loss: 0.4066806
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.4335620
	speed: 0.1488s/iter; left time: 1670.3302s
Epoch: 5 cost time: 2.6086394786834717
Epoch: 5, Steps: 118 | Train Loss: 2.4213018 Vali Loss: 1.2780923 Test Loss: 0.4095776
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.4533634
	speed: 0.1536s/iter; left time: 1706.7482s
Epoch: 6 cost time: 2.420757532119751
Epoch: 6, Steps: 118 | Train Loss: 2.4174956 Vali Loss: 1.2685370 Test Loss: 0.4073236
Validation loss decreased (1.270213 --> 1.268537).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3717721
	speed: 0.1524s/iter; left time: 1674.8858s
Epoch: 7 cost time: 2.4959006309509277
Epoch: 7, Steps: 118 | Train Loss: 2.4147975 Vali Loss: 1.2714583 Test Loss: 0.4078459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4300616
	speed: 0.1480s/iter; left time: 1609.7939s
Epoch: 8 cost time: 2.414212942123413
Epoch: 8, Steps: 118 | Train Loss: 2.4131720 Vali Loss: 1.2721399 Test Loss: 0.4077747
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4257977
	speed: 0.1467s/iter; left time: 1578.5714s
Epoch: 9 cost time: 2.424830436706543
Epoch: 9, Steps: 118 | Train Loss: 2.4129199 Vali Loss: 1.2728157 Test Loss: 0.4079774
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.4356050
	speed: 0.1464s/iter; left time: 1557.5082s
Epoch: 10 cost time: 2.3508126735687256
Epoch: 10, Steps: 118 | Train Loss: 2.4127474 Vali Loss: 1.2703893 Test Loss: 0.4078048
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.4754786
	speed: 0.1485s/iter; left time: 1562.3547s
Epoch: 11 cost time: 2.4186856746673584
Epoch: 11, Steps: 118 | Train Loss: 2.4123059 Vali Loss: 1.2708340 Test Loss: 0.4077728
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.3532345
	speed: 0.1464s/iter; left time: 1522.9865s
Epoch: 12 cost time: 2.358851671218872
Epoch: 12, Steps: 118 | Train Loss: 2.4123082 Vali Loss: 1.2749054 Test Loss: 0.4077315
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.4271929
	speed: 0.1462s/iter; left time: 1503.4110s
Epoch: 13 cost time: 2.4110124111175537
Epoch: 13, Steps: 118 | Train Loss: 2.4119446 Vali Loss: 1.2721382 Test Loss: 0.4077423
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.4471056
	speed: 0.1442s/iter; left time: 1466.5110s
Epoch: 14 cost time: 2.3831498622894287
Epoch: 14, Steps: 118 | Train Loss: 2.4123725 Vali Loss: 1.2708820 Test Loss: 0.4077429
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.3660812
	speed: 0.1492s/iter; left time: 1499.7640s
Epoch: 15 cost time: 2.531304121017456
Epoch: 15, Steps: 118 | Train Loss: 2.4118485 Vali Loss: 1.2751734 Test Loss: 0.4077373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.4092059
	speed: 0.1534s/iter; left time: 1523.2366s
Epoch: 16 cost time: 2.746006965637207
Epoch: 16, Steps: 118 | Train Loss: 2.4120398 Vali Loss: 1.2708677 Test Loss: 0.4077351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_TimeBridge_ETTh1_M_ft720_sl48_ll336_pl128_dm8_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.40732377767562866, mae:0.42686569690704346
rmse:0.6382192373275757, mape:0.6955572366714478, mspe:35159.5

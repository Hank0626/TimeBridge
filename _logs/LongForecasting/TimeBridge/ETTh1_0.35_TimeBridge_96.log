Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=64, is_training=1, model_id='96', model='TimeBridge', data='ETTh1', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/ETT-small/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=96, seasonal_patterns='Monthly', t_layers=3, stable_len=6, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=None, period=24, ratio=1, periods=None, enc_in=7, dec_in=7, c_in=7, sz_row=None, c_out=7, d_model=128, n_heads=8, e_layers=0, d_layers=1, d_ff=128, moving_avg=25, factor=3, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=10, pct_start=0.2, learning_rate=0.0002, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv')
Use GPU: cuda:0
>>>>>>>start training : 96_TimeBridge_ETTh1_M_ft720_sl48_ll96_pl128_dm8_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 1.3967438
	speed: 0.0752s/iter; left time: 909.8689s
Epoch: 1 cost time: 8.012397766113281
Epoch: 1, Steps: 122 | Train Loss: 1.5367981 Vali Loss: 0.8555743 Test Loss: 0.3784201
Validation loss decreased (inf --> 0.855574).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4061396
	speed: 0.1555s/iter; left time: 1862.7082s
Epoch: 2 cost time: 2.4512038230895996
Epoch: 2, Steps: 122 | Train Loss: 1.4194688 Vali Loss: 0.8129613 Test Loss: 0.3624529
Validation loss decreased (0.855574 --> 0.812961).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4116720
	speed: 0.1498s/iter; left time: 1776.3138s
Epoch: 3 cost time: 2.3809051513671875
Epoch: 3, Steps: 122 | Train Loss: 1.3886334 Vali Loss: 0.7937886 Test Loss: 0.3609058
Validation loss decreased (0.812961 --> 0.793789).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3876503
	speed: 0.1484s/iter; left time: 1741.6383s
Epoch: 4 cost time: 2.3864102363586426
Epoch: 4, Steps: 122 | Train Loss: 1.3763689 Vali Loss: 0.7930712 Test Loss: 0.3563299
Validation loss decreased (0.793789 --> 0.793071).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3991604
	speed: 0.1526s/iter; left time: 1772.4340s
Epoch: 5 cost time: 2.460137367248535
Epoch: 5, Steps: 122 | Train Loss: 1.3704395 Vali Loss: 0.7879328 Test Loss: 0.3549707
Validation loss decreased (0.793071 --> 0.787933).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3297478
	speed: 0.1504s/iter; left time: 1728.2627s
Epoch: 6 cost time: 2.3469185829162598
Epoch: 6, Steps: 122 | Train Loss: 1.3669840 Vali Loss: 0.7888009 Test Loss: 0.3540378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3525654
	speed: 0.1587s/iter; left time: 1804.6452s
Epoch: 7 cost time: 2.663315534591675
Epoch: 7, Steps: 122 | Train Loss: 1.3656854 Vali Loss: 0.7854206 Test Loss: 0.3543817
Validation loss decreased (0.787933 --> 0.785421).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3618128
	speed: 0.1561s/iter; left time: 1755.6523s
Epoch: 8 cost time: 2.5238611698150635
Epoch: 8, Steps: 122 | Train Loss: 1.3650129 Vali Loss: 0.7848457 Test Loss: 0.3539246
Validation loss decreased (0.785421 --> 0.784846).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3276434
	speed: 0.1536s/iter; left time: 1708.3923s
Epoch: 9 cost time: 2.404965877532959
Epoch: 9, Steps: 122 | Train Loss: 1.3642773 Vali Loss: 0.7836144 Test Loss: 0.3538238
Validation loss decreased (0.784846 --> 0.783614).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2926941
	speed: 0.1500s/iter; left time: 1650.2994s
Epoch: 10 cost time: 2.4348905086517334
Epoch: 10, Steps: 122 | Train Loss: 1.3641447 Vali Loss: 0.7854674 Test Loss: 0.3537466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4170253
	speed: 0.1505s/iter; left time: 1637.2513s
Epoch: 11 cost time: 2.4254868030548096
Epoch: 11, Steps: 122 | Train Loss: 1.3640484 Vali Loss: 0.7851176 Test Loss: 0.3537481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3755548
	speed: 0.1519s/iter; left time: 1634.4723s
Epoch: 12 cost time: 2.3853747844696045
Epoch: 12, Steps: 122 | Train Loss: 1.3640471 Vali Loss: 0.7833332 Test Loss: 0.3537526
Validation loss decreased (0.783614 --> 0.783333).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3568257
	speed: 0.1538s/iter; left time: 1636.4560s
Epoch: 13 cost time: 2.53387713432312
Epoch: 13, Steps: 122 | Train Loss: 1.3639907 Vali Loss: 0.7855286 Test Loss: 0.3537530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2913563
	speed: 0.1536s/iter; left time: 1615.3808s
Epoch: 14 cost time: 2.4507060050964355
Epoch: 14, Steps: 122 | Train Loss: 1.3639706 Vali Loss: 0.7848881 Test Loss: 0.3537473
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3876284
	speed: 0.1517s/iter; left time: 1577.0245s
Epoch: 15 cost time: 2.4055464267730713
Epoch: 15, Steps: 122 | Train Loss: 1.3638054 Vali Loss: 0.7862657 Test Loss: 0.3537504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4082584
	speed: 0.1511s/iter; left time: 1551.7267s
Epoch: 16 cost time: 2.521630048751831
Epoch: 16, Steps: 122 | Train Loss: 1.3634776 Vali Loss: 0.7834749 Test Loss: 0.3537501
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3471795
	speed: 0.1535s/iter; left time: 1557.7623s
Epoch: 17 cost time: 2.489037036895752
Epoch: 17, Steps: 122 | Train Loss: 1.3639018 Vali Loss: 0.7850384 Test Loss: 0.3537501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3996975
	speed: 0.1499s/iter; left time: 1503.2844s
Epoch: 18 cost time: 2.5212111473083496
Epoch: 18, Steps: 122 | Train Loss: 1.3640101 Vali Loss: 0.7871742 Test Loss: 0.3537502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4184718
	speed: 0.1536s/iter; left time: 1521.8760s
Epoch: 19 cost time: 2.4095332622528076
Epoch: 19, Steps: 122 | Train Loss: 1.3640445 Vali Loss: 0.7848374 Test Loss: 0.3537501
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.3404280
	speed: 0.1508s/iter; left time: 1475.1037s
Epoch: 20 cost time: 2.4350321292877197
Epoch: 20, Steps: 122 | Train Loss: 1.3636817 Vali Loss: 0.7851860 Test Loss: 0.3537501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.2811987
	speed: 0.1507s/iter; left time: 1455.7340s
Epoch: 21 cost time: 2.4382734298706055
Epoch: 21, Steps: 122 | Train Loss: 1.3638430 Vali Loss: 0.7863344 Test Loss: 0.3537501
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3172770
	speed: 0.1600s/iter; left time: 1526.1298s
Epoch: 22 cost time: 2.4662046432495117
Epoch: 22, Steps: 122 | Train Loss: 1.3636471 Vali Loss: 0.7857972 Test Loss: 0.3537501
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 96_TimeBridge_ETTh1_M_ft720_sl48_ll96_pl128_dm8_nh0_el1_dl128_df3_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 1, 96, 7) (2785, 1, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.353752464056015, mae:0.3903641700744629
rmse:0.5947709083557129, mape:0.6647555232048035, mspe:32962.25

Args in experiment:
Namespace(revin=True, alpha=0.35, dropout=0.0, attn_dropout=0.15, batch_size=16, is_training=1, model_id='traffic_720', model='TimeBridge', data='custom', root_path='/cpfs01/projects-HDD/cfff-dea1e1ccd7cb_HDD/wubeiliang/TimeBridge/dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', wo_time=False, seq_len=720, label_len=48, pred_len=720, seasonal_patterns='Monthly', t_layers=1, stable_len=2, use_group=False, random=False, router=None, zero=None, attn_type=None, temporal=False, Asym=True, kernel=25, wavelet='coif3', layer_norm=True, group=None, num_p=8, period=24, ratio=1, periods=None, enc_in=862, dec_in=862, c_in=862, sz_row=None, c_out=862, d_model=512, n_heads=64, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, k_segments=1, distil=True, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=1, train_epochs=100, embedding_epochs=5, patience=5, pct_start=0.2, learning_rate=0.001, embedding_lr=0.0005, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', exp_name='None', efficient_training=False, channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : traffic_720_TimeBridge_custom_M_ft720_sl48_ll720_pl512_dm64_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10841
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 4.4950132
	speed: 0.6831s/iter; left time: 46176.8012s
	iters: 200, epoch: 1 | loss: 4.1756935
	speed: 0.6574s/iter; left time: 44374.7068s
	iters: 300, epoch: 1 | loss: 3.7650104
	speed: 0.6557s/iter; left time: 44195.0058s
	iters: 400, epoch: 1 | loss: 3.5153172
	speed: 0.6577s/iter; left time: 44263.0126s
	iters: 500, epoch: 1 | loss: 3.5748210
	speed: 0.6572s/iter; left time: 44162.7874s
	iters: 600, epoch: 1 | loss: 3.4991784
	speed: 0.6558s/iter; left time: 44003.1823s
Epoch: 1 cost time: 447.14836287498474
Epoch: 1, Steps: 677 | Train Loss: 4.0071692 Vali Loss: 0.4116500 Test Loss: 0.4620867
Validation loss decreased (inf --> 0.411650).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4572651
	speed: 2.4416s/iter; left time: 163403.5055s
	iters: 200, epoch: 2 | loss: 3.3828859
	speed: 0.6461s/iter; left time: 43176.4320s
	iters: 300, epoch: 2 | loss: 3.4846749
	speed: 0.6475s/iter; left time: 43201.4303s
	iters: 400, epoch: 2 | loss: 3.3967028
	speed: 0.6461s/iter; left time: 43042.4468s
	iters: 500, epoch: 2 | loss: 3.3829966
	speed: 0.6462s/iter; left time: 42990.9610s
	iters: 600, epoch: 2 | loss: 3.4069848
	speed: 0.6453s/iter; left time: 42861.2984s
Epoch: 2 cost time: 439.40070247650146
Epoch: 2, Steps: 677 | Train Loss: 3.4224363 Vali Loss: 0.3990074 Test Loss: 0.4430049
Validation loss decreased (0.411650 --> 0.399007).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2673285
	speed: 2.7607s/iter; left time: 182890.1997s
	iters: 200, epoch: 3 | loss: 3.3284345
	speed: 0.6479s/iter; left time: 42858.5476s
	iters: 300, epoch: 3 | loss: 3.3569467
	speed: 0.6455s/iter; left time: 42632.1776s
	iters: 400, epoch: 3 | loss: 3.3181717
	speed: 0.6455s/iter; left time: 42567.0610s
	iters: 500, epoch: 3 | loss: 3.2298701
	speed: 0.6443s/iter; left time: 42423.5372s
	iters: 600, epoch: 3 | loss: 3.2731695
	speed: 0.6455s/iter; left time: 42441.2356s
Epoch: 3 cost time: 439.6472110748291
Epoch: 3, Steps: 677 | Train Loss: 3.2993458 Vali Loss: 0.3944355 Test Loss: 0.4183722
Validation loss decreased (0.399007 --> 0.394435).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2321932
	speed: 2.6853s/iter; left time: 176072.2007s
	iters: 200, epoch: 4 | loss: 3.2891123
	speed: 0.6471s/iter; left time: 42368.8494s
	iters: 300, epoch: 4 | loss: 3.2324479
	speed: 0.6469s/iter; left time: 42289.7666s
	iters: 400, epoch: 4 | loss: 3.1249864
	speed: 0.6465s/iter; left time: 42200.3040s
	iters: 500, epoch: 4 | loss: 3.2390656
	speed: 0.6456s/iter; left time: 42074.9046s
	iters: 600, epoch: 4 | loss: 3.2598872
	speed: 0.6456s/iter; left time: 42006.3599s
Epoch: 4 cost time: 439.938672542572
Epoch: 4, Steps: 677 | Train Loss: 3.2270230 Vali Loss: 0.3896904 Test Loss: 0.4129640
Validation loss decreased (0.394435 --> 0.389690).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1999056
	speed: 2.7240s/iter; left time: 176765.4337s
	iters: 200, epoch: 5 | loss: 3.2364802
	speed: 0.6490s/iter; left time: 42047.9815s
	iters: 300, epoch: 5 | loss: 3.1145282
	speed: 0.6456s/iter; left time: 41765.3541s
	iters: 400, epoch: 5 | loss: 3.1681113
	speed: 0.6457s/iter; left time: 41707.3868s
	iters: 500, epoch: 5 | loss: 3.2383914
	speed: 0.6465s/iter; left time: 41694.4755s
	iters: 600, epoch: 5 | loss: 3.1963775
	speed: 0.6464s/iter; left time: 41621.9606s
Epoch: 5 cost time: 440.42579197883606
Epoch: 5, Steps: 677 | Train Loss: 3.1947719 Vali Loss: 0.3893919 Test Loss: 0.4060347
Validation loss decreased (0.389690 --> 0.389392).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1297705
	speed: 2.6680s/iter; left time: 171325.9709s
	iters: 200, epoch: 6 | loss: 3.1738293
	speed: 0.6450s/iter; left time: 41351.9095s
	iters: 300, epoch: 6 | loss: 3.1654091
	speed: 0.6457s/iter; left time: 41338.1187s
	iters: 400, epoch: 6 | loss: 3.2541211
	speed: 0.6458s/iter; left time: 41277.9858s
	iters: 500, epoch: 6 | loss: 3.1886852
	speed: 0.6475s/iter; left time: 41318.4708s
	iters: 600, epoch: 6 | loss: 3.1500840
	speed: 0.6469s/iter; left time: 41220.4880s
Epoch: 6 cost time: 440.054137468338
Epoch: 6, Steps: 677 | Train Loss: 3.1747581 Vali Loss: 0.3872886 Test Loss: 0.4021220
Validation loss decreased (0.389392 --> 0.387289).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1442480
	speed: 2.7649s/iter; left time: 175681.8592s
	iters: 200, epoch: 7 | loss: 3.0815201
	speed: 0.6459s/iter; left time: 40972.3887s
	iters: 300, epoch: 7 | loss: 3.0769866
	speed: 0.6462s/iter; left time: 40929.6724s
	iters: 400, epoch: 7 | loss: 3.2237434
	speed: 0.6456s/iter; left time: 40826.7045s
	iters: 500, epoch: 7 | loss: 3.1936882
	speed: 0.6483s/iter; left time: 40935.2839s
	iters: 600, epoch: 7 | loss: 3.1115527
	speed: 0.6473s/iter; left time: 40807.8855s
Epoch: 7 cost time: 440.4411063194275
Epoch: 7, Steps: 677 | Train Loss: 3.1622011 Vali Loss: 0.3861507 Test Loss: 0.3991709
Validation loss decreased (0.387289 --> 0.386151).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1125295
	speed: 2.6525s/iter; left time: 166740.2490s
	iters: 200, epoch: 8 | loss: 3.0746379
	speed: 0.6467s/iter; left time: 40589.9537s
	iters: 300, epoch: 8 | loss: 3.2013762
	speed: 0.6479s/iter; left time: 40599.1734s
	iters: 400, epoch: 8 | loss: 3.1350455
	speed: 0.6460s/iter; left time: 40414.3970s
	iters: 500, epoch: 8 | loss: 3.0719261
	speed: 0.6455s/iter; left time: 40317.6271s
	iters: 600, epoch: 8 | loss: 3.1811259
	speed: 0.6476s/iter; left time: 40383.0007s
Epoch: 8 cost time: 439.92716431617737
Epoch: 8, Steps: 677 | Train Loss: 3.1545119 Vali Loss: 0.3874545 Test Loss: 0.3985883
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 3.2093766
	speed: 2.7098s/iter; left time: 168508.6749s
	iters: 200, epoch: 9 | loss: 3.1797657
	speed: 0.6470s/iter; left time: 40168.5766s
	iters: 300, epoch: 9 | loss: 3.2195387
	speed: 0.6471s/iter; left time: 40113.5748s
	iters: 400, epoch: 9 | loss: 3.0817788
	speed: 0.6455s/iter; left time: 39946.5245s
	iters: 500, epoch: 9 | loss: 3.1955683
	speed: 0.6470s/iter; left time: 39974.2712s
	iters: 600, epoch: 9 | loss: 3.2180548
	speed: 0.6461s/iter; left time: 39857.0554s
Epoch: 9 cost time: 440.42021083831787
Epoch: 9, Steps: 677 | Train Loss: 3.1497388 Vali Loss: 0.3861926 Test Loss: 0.3968066
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 3.2045462
	speed: 2.7342s/iter; left time: 168174.4545s
	iters: 200, epoch: 10 | loss: 3.1555934
	speed: 0.6483s/iter; left time: 39813.7861s
	iters: 300, epoch: 10 | loss: 3.1266472
	speed: 0.6504s/iter; left time: 39872.9570s
	iters: 400, epoch: 10 | loss: 3.2924097
	speed: 0.6457s/iter; left time: 39519.9074s
	iters: 500, epoch: 10 | loss: 3.0542347
	speed: 0.6441s/iter; left time: 39357.1934s
	iters: 600, epoch: 10 | loss: 3.2599900
	speed: 0.6454s/iter; left time: 39376.8184s
Epoch: 10 cost time: 440.3251721858978
Epoch: 10, Steps: 677 | Train Loss: 3.1471551 Vali Loss: 0.3857047 Test Loss: 0.3964129
Validation loss decreased (0.386151 --> 0.385705).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0859015
	speed: 2.7868s/iter; left time: 169522.7910s
	iters: 200, epoch: 11 | loss: 3.1632178
	speed: 0.6475s/iter; left time: 39326.3345s
	iters: 300, epoch: 11 | loss: 3.1234686
	speed: 0.6447s/iter; left time: 39090.6098s
	iters: 400, epoch: 11 | loss: 3.2044265
	speed: 0.6465s/iter; left time: 39131.4416s
	iters: 500, epoch: 11 | loss: 3.1113751
	speed: 0.6455s/iter; left time: 39006.0598s
	iters: 600, epoch: 11 | loss: 3.1049933
	speed: 0.6451s/iter; left time: 38921.2778s
Epoch: 11 cost time: 439.6715726852417
Epoch: 11, Steps: 677 | Train Loss: 3.1455792 Vali Loss: 0.3858132 Test Loss: 0.3965470
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 12 | loss: 3.1473856
	speed: 2.6643s/iter; left time: 160265.7992s
	iters: 200, epoch: 12 | loss: 3.1163557
	speed: 0.6472s/iter; left time: 38865.0488s
	iters: 300, epoch: 12 | loss: 3.0673208
	speed: 0.6443s/iter; left time: 38628.2806s
	iters: 400, epoch: 12 | loss: 3.1644218
	speed: 0.6451s/iter; left time: 38614.8023s
	iters: 500, epoch: 12 | loss: 3.2022130
	speed: 0.6463s/iter; left time: 38616.2195s
	iters: 600, epoch: 12 | loss: 3.0940862
	speed: 0.6463s/iter; left time: 38556.5566s
Epoch: 12 cost time: 439.5544927120209
Epoch: 12, Steps: 677 | Train Loss: 3.1448706 Vali Loss: 0.3864975 Test Loss: 0.3961539
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 13 | loss: 3.1569872
	speed: 2.6842s/iter; left time: 159646.1756s
	iters: 200, epoch: 13 | loss: 3.0806642
	speed: 0.6461s/iter; left time: 38364.9130s
	iters: 300, epoch: 13 | loss: 3.1164665
	speed: 0.6455s/iter; left time: 38264.7810s
	iters: 400, epoch: 13 | loss: 3.1578672
	speed: 0.6450s/iter; left time: 38171.5697s
	iters: 500, epoch: 13 | loss: 3.0741026
	speed: 0.6455s/iter; left time: 38136.2850s
	iters: 600, epoch: 13 | loss: 3.1747789
	speed: 0.6469s/iter; left time: 38150.8966s
Epoch: 13 cost time: 439.76545000076294
Epoch: 13, Steps: 677 | Train Loss: 3.1445580 Vali Loss: 0.3855047 Test Loss: 0.3960519
Validation loss decreased (0.385705 --> 0.385505).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.1455798
	speed: 2.6575s/iter; left time: 156263.0567s
	iters: 200, epoch: 14 | loss: 3.1464515
	speed: 0.6434s/iter; left time: 37768.1967s
	iters: 300, epoch: 14 | loss: 3.0693862
	speed: 0.6453s/iter; left time: 37817.1268s
	iters: 400, epoch: 14 | loss: 3.2162225
	speed: 0.6461s/iter; left time: 37797.9146s
	iters: 500, epoch: 14 | loss: 3.0811076
	speed: 0.6466s/iter; left time: 37759.9321s
	iters: 600, epoch: 14 | loss: 3.1002545
	speed: 0.6479s/iter; left time: 37770.3502s
Epoch: 14 cost time: 439.7091431617737
Epoch: 14, Steps: 677 | Train Loss: 3.1443931 Vali Loss: 0.3856932 Test Loss: 0.3960419
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 15 | loss: 3.1769292
	speed: 2.6870s/iter; left time: 156175.0512s
	iters: 200, epoch: 15 | loss: 3.2000101
	speed: 0.6457s/iter; left time: 37466.0375s
	iters: 300, epoch: 15 | loss: 3.1720421
	speed: 0.6457s/iter; left time: 37401.5477s
	iters: 400, epoch: 15 | loss: 3.2222607
	speed: 0.6457s/iter; left time: 37336.3939s
	iters: 500, epoch: 15 | loss: 3.2046521
	speed: 0.6452s/iter; left time: 37241.1332s
	iters: 600, epoch: 15 | loss: 3.2058043
	speed: 0.6463s/iter; left time: 37240.2842s
Epoch: 15 cost time: 439.36532068252563
Epoch: 15, Steps: 677 | Train Loss: 3.1442560 Vali Loss: 0.3858225 Test Loss: 0.3960561
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 16 | loss: 3.2021465
	speed: 2.6415s/iter; left time: 151741.6489s
	iters: 200, epoch: 16 | loss: 3.1550503
	speed: 0.6457s/iter; left time: 37028.2106s
	iters: 300, epoch: 16 | loss: 3.0251238
	speed: 0.6453s/iter; left time: 36943.6036s
	iters: 400, epoch: 16 | loss: 3.1707835
	speed: 0.6454s/iter; left time: 36884.8630s
	iters: 500, epoch: 16 | loss: 3.1103253
	speed: 0.6449s/iter; left time: 36787.1819s
	iters: 600, epoch: 16 | loss: 3.1741786
	speed: 0.6471s/iter; left time: 36847.3520s
Epoch: 16 cost time: 439.4760203361511
Epoch: 16, Steps: 677 | Train Loss: 3.1442206 Vali Loss: 0.3861603 Test Loss: 0.3960892
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 17 | loss: 3.2117832
	speed: 2.6757s/iter; left time: 151896.9627s
	iters: 200, epoch: 17 | loss: 3.1036911
	speed: 0.6457s/iter; left time: 36590.2349s
	iters: 300, epoch: 17 | loss: 3.1132536
	speed: 0.6452s/iter; left time: 36496.5741s
	iters: 400, epoch: 17 | loss: 3.2405484
	speed: 0.6451s/iter; left time: 36426.4652s
	iters: 500, epoch: 17 | loss: 3.0714722
	speed: 0.6443s/iter; left time: 36316.5810s
	iters: 600, epoch: 17 | loss: 3.1711333
	speed: 0.6472s/iter; left time: 36417.9939s
Epoch: 17 cost time: 439.17634415626526
Epoch: 17, Steps: 677 | Train Loss: 3.1441311 Vali Loss: 0.3862644 Test Loss: 0.3960593
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 18 | loss: 3.1846483
	speed: 2.6780s/iter; left time: 150213.5008s
	iters: 200, epoch: 18 | loss: 3.1795514
	speed: 0.6446s/iter; left time: 36093.9851s
	iters: 300, epoch: 18 | loss: 3.1614218
	speed: 0.6454s/iter; left time: 36070.7955s
	iters: 400, epoch: 18 | loss: 3.1672282
	speed: 0.6458s/iter; left time: 36032.5722s
	iters: 500, epoch: 18 | loss: 3.1600716
	speed: 0.6447s/iter; left time: 35902.9016s
	iters: 600, epoch: 18 | loss: 3.1134841
	speed: 0.6450s/iter; left time: 35856.8430s
Epoch: 18 cost time: 439.1882107257843
Epoch: 18, Steps: 677 | Train Loss: 3.1441238 Vali Loss: 0.3865319 Test Loss: 0.3960637
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_720_TimeBridge_custom_M_ft720_sl48_ll720_pl512_dm64_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 1, 720, 862) (2789, 1, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.39605435729026794, mae:0.2655271589756012
rmse:0.6293284893035889, mape:0.45051631331443787, mspe:305717.8125
